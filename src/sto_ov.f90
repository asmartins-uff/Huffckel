! -----------------------------------------------------------------------------
!                             MODULE OVERLAP                              
!
! This module contains all subroutines needed to calculate the overlap between
! The basis orbitals (S, P and D) and to build the Huckel Hamiltonian.
!
! LAST MODIFICATION: 20/12/2012
! -----------------------------------------------------------------------------

module sto_ov
implicit none

! Common Variables to the module:

public :: calcovlp, overlap, arrsel, twocenter

contains

! -----------------------------------------------------------------------------
! SUBROUTINE ARRSEL: Load the arrays that control the cases inside the OVERLAP
! Subroutine.
! -----------------------------------------------------------------------------

subroutine arrsel(nnsel,llsel)
implicit none

!----------------------- Variables and Arrays ---------------------------------
integer, parameter :: lmax = 2, nmax = 5
integer            :: llsel(0:lmax,0:lmax), nnsel(nmax,nmax)
! -----------------------------------------------------------------------------

! The NNSEL(n1,n2) array specific the principal quantum numbers involve.

nnsel(1,1) = 1
nnsel(1,2) = 2
nnsel(1,3) = 3
nnsel(1,4) = 4
nnsel(1,5) = 5
nnsel(2,1) = 2
nnsel(2,2) = 6
nnsel(2,3) = 7
nnsel(2,4) = 8
nnsel(2,5) = 9
nnsel(3,1) = 3
nnsel(3,2) = 7
nnsel(3,3) = 10
nnsel(3,4) = 11
nnsel(3,5) = 12
nnsel(4,1) = 4
nnsel(4,2) = 8
nnsel(4,3) = 11
nnsel(4,4) = 13
nnsel(4,5) = 14
nnsel(5,1) = 5
nnsel(5,2) = 9
nnsel(5,3) = 12
nnsel(5,4) = 14
nnsel(5,5) = 15

! Cases for the overlap between the orbitals:
! llsel = 1 -> <s1|s2>
! llsel = 2 -> <s1|p2>
! llsel = 3 -> <s1|d2>
! llsel = 4 -> <p1|p2>
! llsel = 5 -> <p1|d2>
! llsel = 6 -> <d1|d2>

llsel(0,0) = 0
llsel(0,1) = 1
llsel(0,2) = 2
llsel(1,0) = 3
llsel(1,1) = 4
llsel(1,2) = 5
llsel(2,0) = 6
llsel(2,1) = 7
llsel(2,2) = 8

end subroutine arrsel

! -----------------------------------------------------------------------------
! Compute the overlap matrix among the orbitals of the atoms. In the symmetric
! Case, that is, for systems where the atoms are arranjed in a ordered array,
! The overlap matrix includes only the atoms that belong to the basis of the
! Unit cell.
! -----------------------------------------------------------------------------

subroutine calcovlp(i,j,k,n,nat,numtp,nzt,nval,lval,itype,zeta,cf,ui,uj,&
                    llsel,nnsel,ovout,ipbc)

!----------------------- Variables and Arrays ---------------------------------
! (I) Extern and parameters:
integer, parameter  :: nmax = 5, lmax = 2
integer, intent(in) :: i, j, k, n, nat, numtp, ipbc
integer, intent(in) :: llsel(0:lmax,0:lmax), nnsel(nmax,nmax)
integer, intent(in) :: nzt(numtp,3), nval(numtp,3), lval(numtp,3), itype(nat)
real*8,  intent(in) :: zeta(numtp,3,2), cf(numtp,3,2), ui(3), uj(3)
! (II) Intern:
real*8, intent(out) :: ovout(25)
real*8              :: rho, ovlp(0:lmax), ovin(3), zti, ztj, fc
real*8              :: cl, cm, cn, cl2, cm2, cn2, xij, yij, zij
integer             :: ni, nj, li, lj, iz, jz, llopt, nnopt, kj, lp
! (III) Commons:
real*8              :: sdx, sdy, sdz
! -----------------------------------------------------------------------------

common /sdx / sdx
common /sdy / sdy
common /sdz / sdz

! Initializing OVOUT:

ovout(:) = 0.0d0

! Convertion factor for the distances:

fc = 0.529177d0

! Assigning the ni and li quantum numbers of (I,K) orbital:

ni  = nval(itype(i),k)
li  = lval(itype(i),k)

! Assigning the nj and lj quantum numbers of (J,N) orbital:

nj  = nval(itype(j),n)
lj  = lval(itype(j),n)

! Distance |rj - ri| with PBC (in Bohrs):

  xij = (uj(1) - ui(1)) - dnint((uj(1) - ui(1))/sdx)*sdx*ipbc
  yij = (uj(2) - ui(2)) - dnint((uj(2) - ui(2))/sdy)*sdy*ipbc
  zij = (uj(3) - ui(3)) - dnint((uj(3) - ui(3))/sdz)*sdz*ipbc
  rho = dsqrt(xij**2 + yij**2 + zij**2)/fc

! Loop over the zetas:

ovin(:) = 0.0d0

do iz = 1, nzt(itype(i),k)
  do jz = 1, nzt(itype(j),n)

  zti = zeta(itype(i),k,iz)
  ztj = zeta(itype(j),n,jz)

! Overlap <ni,li|nj,lj>:

  call overlap(ni,nj,li,lj,nnsel,llsel,zti,ztj,rho,ovlp)

  ovin(1) = ovin(1) + cf(itype(i),k,iz)*cf(itype(j),n,jz)*ovlp(0)
  ovin(2) = ovin(2) + cf(itype(i),k,iz)*cf(itype(j),n,jz)*ovlp(1)
  ovin(3) = ovin(3) + cf(itype(i),k,iz)*cf(itype(j),n,jz)*ovlp(2)

  enddo
enddo

! Applying the Two-Center Slater and Koster Rules (SIGNALS TO BE VERYFIED):
! Direction cosines:
!
!   cl  : (xj-xi)/|rj-ri|
!   cm  : (yj-yi)/|rj-ri|
!   cn  : (zj-zi)/|rj-ri|
!   cl2,cm2,cn2: squares of the direction cosines cl,cm,cn

cl = xij/(rho*fc)
cm = yij/(rho*fc)
cn = zij/(rho*fc)
cl2 = cl*cl
cm2 = cm*cm
cn2 = cn*cn
   
call twocenter(li,lj,ovin,ovout,cl,cl2,cm,cm2,cn,cn2)

! End of the subroutine

end subroutine calcovlp

! -----------------------------------------------------------------------------
! Compute the overlap integral between two Slater-Type orbitals (STO), denoted
! by O_q(kp,t). The STO are normalized, with quantum numbers (na, la, m) and
! (nb, lb, m) and screening constants (ka, kb). We have: kp = ka/kb, t = kb*rho 
! And q = (na,nb,la,lb,m) the quantum numbers. The overlaps were tabuled by 
! Michael Barnett and obey the following convention:
! n1, n2: the principal quantum numbers (n1 >= n2)
! l1, l2: azimuthal quantum numbers
!      m: magnetic quantum number
!    rho: distance between the a and b sites (in BOHRS).
! -----------------------------------------------------------------------------

subroutine overlap(n1,n2,l1,l2,nnsel,llsel,zeta1,zeta2,rho,ovlp)
implicit none

!----------------------- Variables and Arrays ---------------------------------
! (I) Extern:
real*8              :: zeta1, zeta2, rho
integer             :: n1, n2, l1, l2
integer, intent(in) :: llsel(0:2,0:2), nnsel(5,5)
! (II) Intern:
real*8  :: ovlp(0:2), pi, k, t, f, skt
integer :: na, nb, la, lb, llopt, nnopt
! -----------------------------------------------------------------------------

! Initializing the overlaps and other parameters:

ovlp(:) = 0
la = l1
lb = l2
na = n1
nb = n2
skt = dfloat(n1)/dfloat(n2)

! The overlap tables impose n1 >= n2. When n1 < n2, we have to interchange the
! Orbitals in order to get the overlap: in this case, we have to redefine K
! And T:

k = zeta1/zeta2
t = zeta2*rho
f = 1.0

! Redefining K and T in order to impose n1 > n2 or, when n1 = n2, to correct
! The overlap signal when l1 < l2:

if(skt.lt.1) then
t = k*t
k = 1./k
f = (-1.)**(l1 + l2)
la = l2
lb = l1
endif

if((skt.eq.1).and.(l1.lt.l2)) then
t = k*t
k = 1./k
f = (-1.)**(l1 + l2)
endif

! Selectioning llopt and nnopt:

llopt = llsel(la,lb)
nnopt = nnsel(n1,n2)

select case(nnopt)

! ------------------------------ n1 = n2 = 1 -----------------------------------
  case(1) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((3.+ 3.*t + t**2)*dexp(-t))/3.
else
ovlp(0) = ovlp(0) + (8*k*((-4*k + k*(-1 + k**2)*t)*exp(-t) + &
                    (4*k + (-1 + k**2)*t)*dexp(-(k*t)))*sqrt(k))/((-1 + k**2)**3*t)
endif

end select

! ------------------------------ n1 = 2 and n2 = 1 -----------------------------
  case(2) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((9 + 9*t + 4*t**2 + t**3)*exp(-t))/(6*sqrt(3.))
else
ovlp(0) = ovlp(0) + (8*k**2*((-4 - 20*k**2 + (-1 + k**2)*(1 + 3*k**2)*t)*exp(-t) + (4 + 20*k**2 &
                  + 8*k*(-1 + k**2)*t + (-1 + k**2)**2*t**2)*exp(-(k*t)))*sqrt(k))/(sqrt(3.)*(-1 + k**2)**4*t)
endif

!*******************
case(3)   ! <p1|s2>
!********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(3 + 3*t + t**2)*exp(-t))/6
else
ovlp(0) = ovlp(0) + (8*k**2*((-24*k - 24*k*t + 4*k*(-1 + k**2)*t**2)*exp(-t) + (24*k + 24*k**2*t &
                  + 8*k*(-1 + k**2)*t**2 + (-1 + k**2)**2*t**3)*exp(-(k*t)))*sqrt(k))/((-1 + k**2)**4*t**2)
endif

end select

! ------------------------------ n1 = 3 and n2 = 1 -----------------------------
  case(3) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((30 + 30*t + 15*t**2 + 5*t**3 + t**4)*exp(-t)*sqrt(2./5.))/30
else
ovlp(0) = ovlp(0) + (8*k**3*((-72*k - 120*k**3 + 12*k*(-1 + k**2)*(1 + k**2)*t)*exp(-t) &
                  + (72*k + 120*k**3 + 12*(-1 + k**2)*(1 + 5*k**2)*t + 12*k*(-1 + k**2)**2*t**2 &
                  + (-1 + k**2)**3*t**3)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(3*(-1 + k**2)**5*t)
endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(30 + 30*t + 13*t**2 + 3*t**3)*exp(-t)*sqrt(2./15.))/30
else
ovlp(0) = ovlp(0) + (8*k**3*((-24 - 168*k**2 - 24*(1 + 7*k**2)*t + 4*(-1 + k**2)*(1 + 5*k**2)*t**2)*exp(-t) &
                  + (24 + 168*k**2 + 24*k*(1 + 7*k**2)*t + 8*(-1 + k**2)*(1 + 8*k**2)*t**2 + 12*k*(-1 &
                  + k**2)**2*t**3 + (-1 + k**2)**3*t**4)*exp(-(k*t)))*sqrt(2./15.)*sqrt(k))/((-1 + k**2)**5*t**2)
endif

!*********************
case(6)   ! <d1|s2>
!**********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(3 + 3*t + t**2)*exp(-t)*sqrt(2.))/30
else
ovlp(0) = ovlp(0) + (8*k**3*((-576*k - 576*k*t + 24*(-3 + k)*k*(3 + k)*t**2 + 24*k*(-1 + k**2)*t**3)*exp(-t) &
                  + (576*k + 576*k**2*t + 24*k*(-3 + 11*k**2)*t**2 + 72*k**2*(-1 + k**2)*t**3 + 12*k*(-1 &
                  + k**2)**2*t**4 + (-1 + k**2)**3*t**5)*exp(-(k*t)))*sqrt(2.)*sqrt(k))/(3*(-1 + k**2)**5*t**3)
endif

end select

! ------------------------------ n1 = 4 and n2 = 1 -----------------------------
  case(4) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((225 + 225*t + 120*t**2 + 45*t**3 + 12*t**4 + 2*t**5)*exp(-t))/(90*sqrt(35.))
else
ovlp(0) = ovlp(0) + (8*k**4*((-72 - 1008*k**2 - 840*k**4 + 12*(-1 + k**2)*(1 + 10*k**2 + 5*k**4)*t)*exp(-t) + &
                    (72 + 1008*k**2 + 840*k**4 + 96*k*(-1 + k**2)*(3 + 5*k**2)*t + 24*(-1 + k**2)**2*(1 + 5*k**2)*t**2 &
                  + 16*k*(-1 + k**2)**3*t**3 + (-1 + k**2)**4*t**4)*exp(-(k*t)))*sqrt(k))/(3*sqrt(35.)*(-1 + k**2)**6*t)
endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(75 + 75*t + 36*t**2 + 11*t**3 + 2*t**4)*exp(-t))/(30*sqrt(105.))
else
ovlp(0) = ovlp(0) + (8*k**4*((-576*k - 1344*k**3 - 192*k*(3 + 7*k**2)*t + 24*k*(-1 + k**2)*(3 + 5*k**2)*t**2)*exp(-t) &
                  + (576*k + 1344*k**3 + 192*k**2*(3 + 7*k**2)*t + 24*k*(-1 + k**2)*(9 + 23*k**2)*t**2 + &
                  4*(-1 + k**2)**2*(5 + 31*k**2)*t**3 + 16*k*(-1 + k**2)**3*t**4 + &
                  (-1 + k**2)**4*t**5)*exp(-(k*t)))*sqrt(k))/(sqrt(105.)*(-1 + k**2)**6*t**2)
endif


!*********************
case(6)   ! <d1|s2>
!**********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(21 + 21*t + 9*t**2 + 2*t**3)*exp(-t))/(90*sqrt(7.))
else
ovlp(0) = ovlp(0) + (8*k**4*((-576 - 5184*k**2 - 576*(1 + 9*k**2)*t + 24*(-9 - 78*k**2 + 7*k**4)*t**2 + &
                 24*(-1 + k**2)*(1 + 7*k**2)*t**3)*exp(-t) + (576 + 5184*k**2 + 576*k*(1 + 9*k**2)*t + &
                 24*(-3 - 18*k**2 + 101*k**4)*t**2 + 24*k*(-1 + k**2)*(3 + 29*k**2)*t**3 + 12*(-1 + k**2)**2*(1 & 
               + 11*k**2)*t**4 + 16*k*(-1 + k**2)**3*t**5 + (-1 + k**2)**4*t**6)*exp(-(k*t)))*sqrt(k))/(3*sqrt(7.)*(-1 &
               + k**2)**6*t**3)
endif

end select

! ------------------------------ n1 = 5 and n2 = 1 -----------------------------
  case(5) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((945 + 945*t + 525*t**2 + 210*t**3 + 63*t**4 + 14*t**5 + 2*t**6)*exp(-t)*sqrt(2./7.))/1890.
else
ovlp(0) = ovlp(0) + (8*k**5*((-2880*k - 13440*k**3 - 6720*k**5 + 120*k*(-1 + k**2)*(3 + k**2)*(1 + 3*k**2)*t)*exp(-t) & 
                  + (2880*k + 13440*k**3 + 6720*k**5 + 120*(-1 + k**2)*(3 + 42*k**2 + 35*k**4)*t + 240*k*(-1 &
                  + k**2)**2*(3 + 5*k**2)*t**2 + 40*(-1 + k**2)**3*(1 + 5*k**2)*t**3 + 20*k*(-1 + k**2)**4*t**4  &
                  + (-1 + k**2)**5*t**5)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/(45*(-1 + k**2)**7*t)
endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(1575 + 1575*t + 798*t**2 + 273*t**3 + 66*t**4 + 10*t**5)*exp(-t)*sqrt(2./21.))/3150. 
else
ovlp(0) = ovlp(0) + (8*k**5*((-576 - 10368*k**2 - 12096*k**4 - 576*(1 + 18*k**2 + 21*k**4)*t + 24*(-1 &
                  + k**2)*(3 + 42*k**2 + 35*k**4)*t**2)*exp(-t) + (576 + 10368*k**2 + 12096*k**4 &
                  + 576*k*(1 + 18*k**2 + 21*k**4)*t + 24*(-1 + k**2)*(9 + 174*k**2 + 217*k**4)*t**2 + 48*k*(-1 &
                  + k**2)**2*(13 + 27*k**2)*t**3 + 12*(-1 + k**2)**3*(3 + 17*k**2)*t**4 + 20*k*(-1 + k**2)**4*t**5 &
                  + (-1 + k**2)**5*t**6)*exp(-(k*t)))*sqrt(2./21.)*sqrt(k))/(15*(-1 + k**2)**7*t**2)
endif

!*********************
case(6)   ! <d1|s2>
!**********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((210*t**3 + 210*t**4 + 99*t**5 + 29*t**6 + 5*t**7)*exp(-t)*sqrt(2./35.))/(945*t)
else
ovlp(0) = ovlp(0) + (8*k**5*((-17280*k - 51840*k**3 - 17280*k*(1 + 3*k**2)*t + 192*k*(-33 - 94*k**2 + 7*k**4)*t**2 &
                  + 192*k*(-1 + k**2)*(3 + 7*k**2)*t**3)*exp(-t) + (17280*k + 51840*k**3 + 17280*k**2*(1 + 3*k**2)*t &
                  + 768*k*(-3 + k**2 + 32*k**4)*t**2 + 384*k**2*(-1 + k**2)*(6 + 19*k**2)*t**3 + 48*k*(-1 &
                  + k**2)**2*(9 + 31*k**2)*t**4 + 4*(-1 + k**2)**3*(7 + 53*k**2)*t**5 + 20*k*(-1 + k**2)**4*t**6 &
                  + (-1 + k**2)**5*t**7)*exp(-(k*t)))*sqrt(2./35.)*sqrt(k))/(9*(-1 + k**2)**7*t**3)
endif


end select

! ------------------------------ n1 = n2 = 2 -----------------------------------
  case(6) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((45 + 45*t + 20*t**2 + 5*t**3 + t**4)*exp(-t))/45
else
ovlp(0) = ovlp(0) + (8*k**2*((20 + 152*k**2 + 20*k**4 - 8*(-1 + k**2)*(1 + 5*k**2)*t + (-1 + k**2)**2*(1 &
                  + 3*k**2)*t**2)*exp(-t) + (-20 - 152*k**2 - 20*k**4 - 8*k*(-1 + k**2)*(5 + k**2)*t &
                  - (-1 + k**2)**2*(3 + k**2)*t**2)*exp(-(k*t)))*sqrt(k))/(3*(-1 + k**2)**5*t)
endif

!*********************************
case(1,3)   ! <s1|p2> or <p1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) +(t*(15 + 15*t + 7*t**2 + 2*t**3)*exp(-t))/(30*sqrt(3.))
else
ovlp(0) = ovlp(0) + (-8*k**2*((-168*k - 24*k**3 - 24*k*(7 + k**2)*t + 4*k*(-1 + k**2)*(11 + k**2)*t**2 - 4*k*(-1 &
                  + k**2)**2*t**3)*exp(-t) + (168*k + 24*k**3 + 24*k**2*(7 + k**2)*t + 8*k*(-1 + k**2)*(5 &
                  + k**2)*t**2 + (-1 + k**2)**2*(3 + k**2)*t**3)*exp(-(k*t)))*sqrt(k))/(sqrt(3.)*(-1 + k**2)**5*t**2)
endif

!*********************************
case(4)   ! l1 = l2 = 1 => <p1|p2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((15*t + 15*t**2 + 3*t**3 - 2*t**4 - t**5)*exp(-t))/(15*t)
ovlp(1) = ovlp(1) - ((-15*t - 15*t**2 - 6*t**3 - t**4)*exp(-t))/(15*t)
else
ovlp(0) = ovlp(0) + (-32*k**2*((96*k + 96*k*t + 48*k*t**2 - k*(-1 + k**2)*(11 + k**2)*t**3 + k*(-1 &
                  + k**2)**2*t**4)*exp(-t) + (-96*k - 96*k**2*t - 48*k**3*t**2 - (-1 + k**2)*(1 + 11*k**2)*t**3 &
                  - k*(-1 + k**2)**2*t**4)*exp(-(k*t)))*sqrt(k))/((-1 + k**2)**5*t**3)
ovlp(1) = ovlp(1) + (32*k**2*((48*k + 48*k*t - 12*k*(-1 + k**2)*t**2 + k*(-1 + k**2)**2*t**3)*exp(-t) &
                  + (-48*k - 48*k**2*t - 12*k*(-1 + k**2)*t**2 &
                  - (-1 + k**2)**2*t**3)*exp(-(k*t)))*sqrt(k))/((-1 + k**2)**5*t**3)
endif

end select

! ------------------------------ n1 = 3 and n2 = 2 -----------------------------
  case(7) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((225 + 225*t + 105*t**2 + 30*t**3 + 6*t**4 + t**5)*exp(-t)*sqrt(2./15.))/90
else
ovlp(0) = ovlp(0) + (-8*k**3*((-504*k - 1296*k**3 - 120*k**5 + 48*k*(-1 + k**2)*(3 + 5*k**2)*t &
                  - 12*k*(-1 + k**2)**2*(1 + k**2)*t**2)*exp(-t) + (504*k + 1296*k**3 + 120*k**5 &
                  + 12*(-1 + k**2)*(5 + 38*k**2 + 5*k**4)*t + 12*k*(-1 + k**2)**2*(5 + k**2)*t**2 &
                  + (-1 + k**2)**3*(3 + k**2)*t**3)*exp(-(k*t)))*sqrt(2./15.)*sqrt(k))/(3*(-1 + k**2)**6*t)
endif

!*******************
case(1)   ! <s1|p2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-15*t**2 - 15*t**3 - 9*t**4 - 4*t**5 - t**6)*exp(-t)*sqrt(2./5.))/(90*t)
else
ovlp(0) = ovlp(0) + (32*k**3*((-144*k - 336*k**3 - 48*k*(3 + 7*k**2)*t + 12*k*(-1 + k**2)*(3 + 5*k**2)*t**2 &
                  - 3*k*(-1 + k**2)**2*(1 + k**2)*t**3)*exp(-t) + (144*k + 336*k**3 + 48*k**2*(3 + 7*k**2)*t &
                  + 36*k*(-1 + k**2)*(1 + 3*k**2)*t**2 + 2*(-1 + k**2)**2*(1 + 8*k**2)*t**3 &
                  + k*(-1 + k**2)**3*t**4)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(3*(-1 + k**2)**6*t**2)
endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(45 + 45*t + 20*t**2 + 5*t**3 + t**4)*exp(-t)*sqrt(2./5.))/90
else
ovlp(0) = ovlp(0) + (-8*k**3*((-168 - 1584*k**2 - 168*k**4 - 24*(7 + 66*k**2 + 7*k**4)*t &
                  + 4*(-1 + k**2)*(11 + 80*k**2 + 5*k**4)*t**2 - 4*(-1 + k**2)**2*(1 + 5*k**2)*t**3)*exp(-t) &
                  + (168 + 1584*k**2 + 168*k**4 + 24*k*(7 + 66*k**2 + 7*k**4)*t + 8*(-1 + k**2)*(5 + 59*k**2 &
                  + 8*k**4)*t**2 + 12*k*(-1 + k**2)**2*(5 + k**2)*t**3 + (-1 + k**2)**3*(3 &
                  + k**2)*t**4)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(3*(-1 + k**2)**6*t**2)
endif

!*********************************
case(4)   ! l1 = l2 = 1 => <p1|p2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((75*t + 75*t**2 + 24*t**3 - t**4 - 3*t**5 - t**6)*exp(-t)*sqrt(2./15.))/(30*t)
ovlp(1) = ovlp(1) - ((-75*t - 75*t**2 - 33*t**3 - 8*t**4 - t**5)*exp(-t)*sqrt(2./15.))/(30*t)
else
ovlp(0) = ovlp(0) + (32*k**3*((-96 - 864*k**2 - 96*(1 + 9*k**2)*t - 48*(1 + 9*k**2)*t**2 &
                  + (-1 + k**2)*(11 + 80*k**2 + 5*k**4)*t**3 - (-1 + k**2)**2*(1 + 5*k**2)*t**4)*exp(-t) &
                  + (96 + 864*k**2 + 96*k*(1 + 9*k**2)*t + 48*k**2*(1 + 9*k**2)*t**2 + 6*k*(-1 &
                  + k**2)*(5 + 19*k**2)*t**3 + 2*(-1 + k**2)**2*(1 + 8*k**2)*t**4 + k*(-1 &
                  + k**2)**3*t**5)*exp(-(k*t)))*sqrt(2./15.)*sqrt(k))/((-1 + k**2)**6*t**3)

ovlp(1) = ovlp(1) + (-32*k**3*((-48 - 432*k**2 - 48*(1 + 9*k**2)*t + 12*(-1 + k**2)*(1 + 7*k**2)*t**2 &
                  - (-1 + k**2)**2*(1 + 5*k**2)*t**3)*exp(-t) + (48 + 432*k**2 + 48*k*(1 + 9*k**2)*t &
                  + 12*(-1 + k**2)*(1 + 11*k**2)*t**2 + 18*k*(-1 + k**2)**2*t**3 + (-1 &
                  + k**2)**3*t**4)*exp(-(k*t)))*sqrt(2./15.)*sqrt(k))/((-1 + k**2)**6*t**3)

endif

!********************
case(6)   ! <d1|s2>
!********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(6 + 6*t + 3*t**2 + t**3)*exp(-t)*sqrt(2./3.))/90
else
ovlp(0) = ovlp(0) + (-8*k**3*((-5184*k - 576*k**3 - 576*k*(9 + k**2)*t + 24*k*(-87 + 6*k**2 &
                  + k**4)*t**2 + 24*k*(-1 + k**2)*(15 + k**2)*t**3 - 24*k*(-1 + k**2)**2*t**4)*exp(-t) &
                  + (5184*k + 576*k**3 + 576*k**2*(9 + k**2)*t + 24*k*(-21 + 90*k**2 + 11*k**4)*t**2 &
                  + 72*k**2*(-1 + k**2)*(7 + k**2)*t**3 + 12*k*(-1 + k**2)**2*(5 + k**2)*t**4 &
                  + (-1 + k**2)**3*(3 + k**2)*t**5)*exp(-(k*t)))*sqrt(2./3.)*sqrt(k))/(3*(-1 + k**2)**6*t**3)

endif

!*********************
case(7)  ! <d1|p2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((30*t**2 + 30*t**3 + 9*t**4 - t**5 - t**6)*exp(-t)*sqrt(2.))/(90*t)
ovlp(1) = ovlp(1) + ((15*t**2 + 15*t**3 + 6*t**4 + t**5)*exp(-t)*sqrt(2./3.))/(30*t)
else
ovlp(0) = ovlp(0) + (32*k**3*((-4320*k - 4320*k*t + 96*k*(-21 + k**2)*t**2 + 96*k*(-6 + k**2)*t**3 &
                  + 6*k*(-1 + k**2)*(15 + k**2)*t**4 - 6*k*(-1 + k**2)**2*t**5)*exp(-t) + (4320*k  &
                  + 4320*k**2*t + 48*k*(-3 + 43*k**2)*t**2 + 48*k**2*(-3 + 13*k**2)*t**3 + 18*k*(-1 &
                  + k**2)*(1 + 7*k**2)*t**4 + 2*(-1 + k**2)**2*(1 + 8*k**2)*t**5 + k*(-1 &
                  + k**2)**3*t**6)*exp(-(k*t)))*sqrt(2.)*sqrt(k))/(3*(-1 + k**2)**6*t**4)

ovlp(1) = ovlp(1) + (-32*k**3*((-1440*k - 1440*k*t + 96*k*(-6 + k**2)*t**2 + 96*k*(-1 + k**2)*t**3 &
                  - 6*k*(-1 + k**2)**2*t**4)*exp(-t) + (1440*k + 1440*k**2*t + 48*k*(-3 + 13*k**2)*t**2 &
                  + 144*k**2*(-1 + k**2)*t**3 + 18*k*(-1 + k**2)**2*t**4 + (-1 &
                  + k**2)**3*t**5)*exp(-(k*t)))*sqrt(2./3.)*sqrt(k))/((-1 + k**2)**6*t**4)

endif

end select

! ------------------------------ n1 = 4 and n2 = 2 -----------------------------
  case(8) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((4725 + 4725*t + 2310*t**2 + 735*t**3 + 168*t**4 + 28*t**5 + 4*t**6)*exp(-t))/&
                    (630*sqrt(105.))
else
ovlp(0) = ovlp(0) + (-8*k**4*((-504 - 9432*k**2 - 12264*k**4 - 840*k**6 + 48*(-1 + k**2)*(3 + 42*k**2 &
                  + 35*k**4)*t - 12*(-1 + k**2)**2*(1 + 10*k**2 + 5*k**4)*t**2)*exp(-t) + (504 + 9432*k**2 &
                  + 12264*k**4 + 840*k**6 + 96*k*(-1 + k**2)*(21 + 54*k**2 + 5*k**4)*t + 24*(-1 + k**2)**2*(5 &
                  + 38*k**2 + 5*k**4)*t**2 + 16*k*(-1 + k**2)**3*(5 + k**2)*t**3 + (-1 + k**2)**4*(3 + &
                    k**2)*t**4)*exp(-(k*t)))*sqrt(k))/(3*sqrt(105.)*(-1 + k**2)**7*t)
endif

!*******************
case(1)   ! <s1|p2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-21*t**4 - 21*t**5 - 9*t**6 - 2*t**7)*exp(-t))/(315*t*sqrt(35.))
else
ovlp(0) = ovlp(0) + (32*k**4*((-144 - 2592*k**2 - 3024*k**4 - 144*(1 + 18*k**2 + 21*k**4)*t + 12*(-1 &
                  + k**2)*(3 + 42*k**2 + 35*k**4)*t**2 - 3*(-1 + k**2)**2*(1 + 10*k**2 + 5*k**4)*t**3)*exp(-t) &
                  + (144 + 2592*k**2 + 3024*k**4 + 144*k*(1 + 18*k**2 + 21*k**4)*t + 12*(-1 + k**2)*(3 + 66*k**2 &
                  + 91*k**4)*t**2 + 12*k*(-1 + k**2)**2*(7 + 17*k**2)*t**3 + 3*(-1 + k**2)**3*(1 + 7*k**2)*t**4 &
                  + k*(-1 + k**2)**4*t**5)*exp(-(k*t)))*sqrt(k))/(3*Sqrt(35.)*(-1 + k**2)**7*t**2)
endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(1050 + 1050*t + 483*t**2 + 133*t**3 + 25*t**4 + 4*t**5)*exp(-t))/(630*sqrt(35.))
else
ovlp(0) = ovlp(0) + (-8*k**4*((-5184*k - 16512*k**3 - 1344*k**5 - 192*k*(27 + 86*k**2 + 7*k**4)*t &
                  + 120*k*(-1 + k**2)*(9 + 22*k**2 + k**4)*t**2 - 24*k*(-1 + k**2)**2*(3 + 5*k**2)*t**3)*exp(-t) &
                  + (5184*k + 16512*k**3 + 1344*k**5 + 192*k**2*(27 + 86*k**2 + 7*k**4)*t + 24*k*(-1 + k**2)*(63 &
                  + 234*k**2 + 23*k**4)*t**2 + 4*(-1 + k**2)**2*(25 + 232*k**2 + 31*k**4)*t**3 + 16*k*(-1 &
                  + k**2)**3*(5 + k**2)*t**4 + (-1 + k**2)**4*(3 + k**2)*t**5)*exp(-(k*t)))*sqrt(k))/(3*sqrt(35.)*(-1 &
                  + k**2)**7*t**2)
endif

!*********************************
case(4)   ! l1 = l2 = 1 => <p1|p2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((1575*t + 1575*t**2 + 630*t**3 + 105*t**4 - 15*t**5 - 15*t**6 - 4*t**7)*exp(-t))/&
                    (210*t*sqrt(105.))
ovlp(1) = ovlp(1) - ((-1575*t - 1575*t**2 - 735*t**3 - 210*t**4 - 39*t**5 - 4*t**6)*exp(-t))/(210*t*sqrt(105.))
else
ovlp(0) = ovlp(0) + (32*k**4*((-2880*k - 8640*k**3 - 2880*k*(1 + 3*k**2)*t - 1440*k*(1 + 3*k**2)*t**2 &
                  +  30*k*(-1 + k**2)*(9 + 22*k**2 + k**4)*t**3 - 6*k*(-1 + k**2)**2*(3 + 5*k**2)*t**4)*exp(-t) &
                  + (2880*k + 8640*k**3 + 2880*k**2*(1 + 3*k**2)*t + 1440*k**3*(1 + 3*k**2)*t**2 + 30*(-1 &
                  + k**2)*(1 + 22*k**2 + 41*k**4)*t**3 + 6*k*(-1 + k**2)**2*(13 + 35*k**2)*t**4 + 3*(-1 &
                  + k**2)**3*(1 + 7*k**2)*t**5 + k*(-1 + k**2)**4*t**6)*exp(-(k*t)))*sqrt(k))/(sqrt(105.)*(-1 &
                  + k**2)**7*t**3)

ovlp(1) = ovlp(1) + (-32*k**4*((-1440*k - 4320*k**3 - 1440*k*(1 + 3*k**2)*t + 96*k*(-1 + k**2)*(3 + 7*k**2)*t**2 &
                  - 6*k*(-1 + k**2)**2*(3 + 5*k**2)*t**3)*exp(-t) + (1440*k + 4320*k**3 + 1440*k**2*(1 + 3*k**2)*t &
                  + 48*k*(-1 + k**2)*(9 + 31*k**2)*t**2 + 6*(-1 + k**2)**2*(5 + 43*k**2)*t**3 + 24*k*(-1 &
                  + k**2)**3*t**4 + (-1 + k**2)**4*t**5)*exp(-(k*t)))*sqrt(k))/(sqrt(105.)*(-1 + k**2)**7*t**3)

endif

!********************
case(6)   ! <d1|s2>
!********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(168 + 168*t + 75*t**2 + 19*t**3 + 4*t**4)*exp(-t))/(630*sqrt(21.))
else
ovlp(0) = ovlp(0) + (-8*k**4*((-5184 - 58752*k**2 - 5184*k**4 - 1728*(3 + 34*k**2 + 3*k**4)*t &
                  + 24*(-87 - 939*k**2 + 59*k**4 + 7*k**6)*t**2 + 24*(-1 + k**2)*(15 + 138*k**2 &
                  + 7*k**4)*t**3 - 24*(-1 + k**2)**2*(1 + 7*k**2)*t**4)*exp(-t) + (5184 + 58752*k**2 &
                  + 5184*k**4 + 1728*k*(3 + 34*k**2 + 3*k**4)*t + 24*(-21 - 177*k**2 + 1057*k**4 + 101*k**6)*t**2 &
                  + 24*k*(-1 + k**2)*(21 + 270*k**2 + 29*k**4)*t**3 + 12*(-1 + k**2)**2*(5 + 80*k**2 &
                  + 11*k**4)*t**4 + 16*k*(-1 + k**2)**3*(5 + k**2)*t**5 + (-1 + k**2)**4*(3 &
                  + k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(3*Sqrt(21.)*(-1 + k**2)**7*t**3)

endif

!*********************
case(7)  ! <d1|p2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((630*t**2 + 630*t**3 + 237*t**4 + 27*t**5 - 9*t**6 - 4*t**7)*exp(-t))/(630*t*sqrt(7.))
ovlp(1) = ovlp(1) + ((315*t**2 + 315*t**3 + 138*t**4 + 33*t**5 + 4*t**6)*exp(-t))/(210*t*sqrt(21.))
else
ovlp(0) = ovlp(0) + (32*k**4*((-4320 - 47520*k**2 - 4320*(1 + 11*k**2)*t + 288*(-7 - 76*k**2 + 3*k**4)*t**2 &
                  + 288*(-2 - 21*k**2 + 3*k**4)*t**3 + 6*(-1 + k**2)*(15 + 138*k**2 + 7*k**4)*t**4 - 6*(-1 &
                  + k**2)**2*(1 + 7*k**2)*t**5)*exp(-t) + (4320 + 47520*k**2 + 4320*k*(1 + 11*k**2)*t + 144*(-1 &
                  + 2*k**2 + 159*k**4)*t**2 + 144*k*(-1 - 8*k**2 + 49*k**4)*t**3 + 6*(-1 + k**2)*(3 + 66*k**2 &
                  + 251*k**4)*t**4 + 6*k*(-1 + k**2)**2*(11 + 37*k**2)*t**5 + 3*(-1 + k**2)**3*(1 + 7*k**2)*t**6 &
                  + k*(-1 + k**2)**4*t**7)*exp(-(k*t)))*sqrt(k))/(3*sqrt(7.)*(-1 + k**2)**7*t**4)
 
ovlp(1) = ovlp(1) + (-32*k**4*((-1440 - 15840*k**2 - 1440*(1 + 11*k**2)*t + 288*(-2 - 21*k**2 + 3*k**4)*t**2 &
                  + 96*(-1 + k**2)*(1 + 9*k**2)*t**3 - 6*(-1 + k**2)**2*(1 + 7*k**2)*t**4)*exp(-t) + (1440 &
                  + 15840*k**2 + 1440*k*(1 + 11*k**2)*t + 144*(-1 - 8*k**2 + 49*k**4)*t**2 + 48*k*(-1 + k**2)*(3 &
                  + 37*k**2)*t**3 + 18*(-1 + k**2)**2*(1 + 15*k**2)*t**4 + 24*k*(-1 + k**2)**3*t**5 + (-1 &
                  + k**2)**4*t**6)*exp(-(k*t)))*sqrt(k))/(sqrt(21.)*(-1 + k**2)**7*t**4)

endif

end select

! ------------------------------ n1 = 5 and n2 = 2 -----------------------------
  case(9) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((6615 + 6615*t + 3360*t**2 + 1155*t**3 + 294*t**4 + 56*t**5 + 8*t**6 &
                  + t**7)*exp(-t)*sqrt(2./21.))/3780.
else
ovlp(0) = ovlp(0) + (-8*k**5*((-25920*k - 162240*k**3 - 127680*k**5 - 6720*k**7 + 1920*k*(-1 + k**2)*(3 + 14*k**2 &
                  + 7*k**4)*t - 120*k*(-1 + k**2)**2*(3 + k**2)*(1 + 3*k**2)*t**2)*exp(-t) + (25920*k + 162240*k**3 &
                  + 127680*k**5 + 6720*k**7 + 120*(-1 + k**2)*(21 + 393*k**2 + 511*k**4 + 35*k**6)*t + 240*k*(-1 &
                  + k**2)**2*(21 + 54*k**2 + 5*k**4)*t**2 + 40*(-1 + k**2)**3*(5 + 38*k**2 + 5*k**4)*t**3 + 20*k*(-1 &
                  + k**2)**4*(5 + k**2)*t**4 + (-1 + k**2)**5*(3 + k**2)*t**5)*exp(-(k*t)))*sqrt(2./21.)*sqrt(k))/(45*(-1 &
                  + k**2)**8*t)

endif

!*******************
case(1)   ! <s1|p2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((315*t**2 + 315*t**3 + 105*t**4 - 12*t**6 - 5*t**7 - t**8)*exp(-t)*sqrt(2./7.))/(3780*t)
else
ovlp(0) = ovlp(0) + (32*k**5*((-7200*k - 43200*k**3 - 30240*k**5 - 1440*k*(5 + 30*k**2 + 21*k**4)*t + 480*k*(-1 &
                  + k**2)*(3 + 14*k**2 + 7*k**4)*t**2 - 30*k*(-1 + k**2)**2*(3 + k**2)*(1 + 3*k**2)*t**3)*exp(-t) &
                  + (7200*k + 43200*k**3 + 30240*k**5 + 1440*k**2*(5 + 30*k**2 + 21*k**4)*t + 240*k*(-1 + k**2)*(9 &
                  + 62*k**2 + 49*k**4)*t**2 + 120*(-1 + k**2)**2*(1 + 18*k**2 + 21*k**4)*t**3 + 30*k*(-1 + k**2)**3*(5 &
                  + 11*k**2)*t**4 + 2*(-1 + k**2)**4*(2 + 13*k**2)*t**5 + k*(-1 &
                  + k**2)**5*t**6)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/(45*(-1 + k**2)**8*t**2)
endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(7875 + 7875*t + 3759*t**2 + 1134*t**3 + 240*t**4 + 37*t**5 + 5*t**6)*exp(-t)*sqrt(2./7.))/18900.
else
ovlp(0) = ovlp(0) + (-8*k**5*((-5184 - 116928*k**2 - 188352*k**4 - 12096*k**6 - 576*(9 + 203*k**2 + 327*k**4 &
                  + 21*k**6)*t + 120*(-1 + k**2)*(9 + 165*k**2 + 203*k**4 + 7*k**6)*t**2 - 24*(-1 + k**2)**2*(3 &
                  + 42*k**2 + 35*k**4)*t**3)*exp(-t) + (5184 + 116928*k**2 + 188352*k**4 + 12096*k**6 + 576*k*(9 &
                  + 203*k**2 + 327*k**4 + 21*k**6)*t + 24*(-1 + k**2)*(63 + 1611*k**2 + 2909*k**4 + 217*k**6)*t**2 &
                  + 48*k*(-1 + k**2)**2*(1 + 3*k**2)*(91 + 9*k**2)*t**3 + 12*(-1 + k**2)**3*(15 + 128*k**2 &
                  + 17*k**4)*t**4 + 20*k*(-1 + k**2)**4*(5 + k**2)*t**5 + (-1 + k**2)**5*(3 &
                  + k**2)*t**6)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/(45*(-1 + k**2)**8*t**2)

endif

!*********************************
case(4)   ! l1 = l2 = 1 => <p1|p2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((11025*t + 11025*t**2 + 5040*t**3 + 1365*t**4 + 180*t**5 - 30*t**6 - 22*t**7 &
                  - 5*t**8)*exp(-t)*sqrt(2./21.))/(6300*t)
ovlp(1) = ovlp(1) - ((-11025*t - 11025*t**2 - 5355*t**3 - 1680*t**4 - 372*t**5 - 57*t**6 &
                  - 5*t**7)*exp(-t)*sqrt(2./21.))/(6300*t)
else
ovlp(0) = ovlp(0) + (32*k**5*((-2880 - 63360*k**2 - 95040*k**4 - 2880*(1 + 22*k**2 + 33*k**4)*t - 1440*(1 + 22*k**2 &
                  + 33*k**4)*t**2 + 30*(-1 + k**2)*(9 + 165*k**2 + 203*k**4 + 7*k**6)*t**3 - 6*(-1 + k**2)**2*(3 &
                  + 42*k**2 + 35*k**4)*t**4)*exp(-t) + (2880 + 63360*k**2 + 95040*k**4 + 2880*k*(1 + 22*k**2 &
                  + 33*k**4)*t + 1440*k**2*(1 + 22*k**2 + 33*k**4)*t**2 + 240*k*(-1 + k**2)*(7 + 54*k**2 &
                  + 59*k**4)*t**3 + 12*(-1 + k**2)**2*(9 + 166*k**2 + 225*k**4)*t**4 + 48*k*(-1 + k**2)**3*(3 &
                  + 7*k**2)*t**5 + 2*(-1 + k**2)**4*(2 + 13*k**2)*t**6 + k*(-1 &
                  + k**2)**5*t**7)*exp(-(k*t)))*sqrt(2./21.)*sqrt(k))/(15*(-1 + k**2)**8*t**3)

ovlp(1) = ovlp(1) + (-32*k**5*((-1440 - 31680*k**2 - 47520*k**4 - 1440*(1 + 22*k**2 + 33*k**4)*t + 288*(-1 + k**2)*(1 &
                  + 18*k**2 + 21*k**4)*t**2 - 6*(-1 + k**2)**2*(3 + 42*k**2 + 35*k**4)*t**3)*exp(-t) + (1440 &
                  + 31680*k**2 + 47520*k**4 + 1440*k*(1 + 22*k**2 + 33*k**4)*t + 144*(-1 + k**2)*(3 + 74*k**2 &
                  + 123*k**4)*t**2 + 96*k*(-1 + k**2)**2*(13 + 37*k**2)*t**3 + 6*(-1 + k**2)**3*(9 + 71*k**2)*t**4 &
                  + 30*k*(-1 + k**2)**4*t**5 + (-1 + k**2)**5*t**6)*exp(-(k*t)))*sqrt(2./21.)*sqrt(k))/(15*(-1 + k**2)**8*t**3)

endif

!********************
case(6)   ! <d1|s2>
!********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(1365 + 1365*t + 624*t**2 + 169*t**3 + 31*t**4 + 5*t**5)*exp(-t)*sqrt(2./105.))/3780.
else
ovlp(0) = ovlp(0) + (-8*k**5*((-190080*k - 725760*k**3 - 51840*k**5 - 17280*k*(11 + 42*k**2 + 3*k**4)*t + 192*k*(-387 &
                  - 1379*k**2 + 79*k**4 + 7*k**6)*t**2 + 192*k*(-1 + k**2)*(57 + 176*k**2 + 7*k**4)*t**3 - 192*k*(-1 &
                  + k**2)**2*(3 + 7*k**2)*t**4)*exp(-t) + (190080*k + 725760*k**3 + 51840*k**5 + 17280*k**2*(11 + 42*k**2 &
                  + 3*k**4)*t + 768*k*(-27 - 4*k**2 + 419*k**4 + 32*k**6)*t**2 + 384*k**2*(-1 + k**2)*(54 + 227*k**2 &
                  + 19*k**4)*t**3 + 48*k*(-1 + k**2)**2*(63 + 306*k**2 + 31*k**4)*t**4 + 4*(-1 + k**2)**3*(35 + 392*k**2 &
                  + 53*k**4)*t**5 + 20*k*(-1 + k**2)**4*(5 + k**2)*t**6 + (-1 + k**2)**5*(3 &
                  + k**2)*t**7)*exp(-(k*t)))*sqrt(2./105.)*sqrt(k))/(9*(-1 + k**2)**8*t**3)

endif

!*********************
case(7)  ! <d1|p2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((4410*t**2 + 4410*t**3 + 1875*t**4 + 405*t**5 + 21*t**6 - 16*t**7 - 5*t**8)*exp(-t)*sqrt(2./35.))/(3780*t)
ovlp(1) = ovlp(1) + ((2205*t**2 + 2205*t**3 + 1020*t**4 + 285*t**5 + 51*t**6 + 5*t**7)*exp(-t)*sqrt(2./105.))/(1260*t)
else
ovlp(0) = ovlp(0) + (32*k**5*((-155520*k - 570240*k**3 - 51840*k*(3 + 11*k**2)*t + 2880*k*(-25 - 90*k**2 + 3*k**4)*t**2 &
                  + 2880*k*(-7 - 24*k**2 + 3*k**4)*t**3 + 48*k*(-1 + k**2)*(57 + 176*k**2 + 7*k**4)*t**4 - 48*k*(-1 &
                  + k**2)**2*(3 + 7*k**2)*t**5)*exp(-t) + (155520*k + 570240*k**3 + 51840*k**2*(3 + 11*k**2)*t + 5760*k*(-1 &
                  + 9*k**2 + 48*k**4)*t**2 + 5760*k**2*(-1 + 15*k**4)*t**3 + 96*k*(-1 + k**2)*(9 + 92*k**2 + 199*k**4)*t**4 &
                  + 12*(-1 + k**2)**2*(7 + 138*k**2 + 255*k**4)*t**5 + 12*k*(-1 + k**2)**3*(11 + 29*k**2)*t**6 + 2*(-1 &
                + k**2)**4*(2 + 13*k**2)*t**7 + k*(-1 + k**2)**5*t**8)*exp(-(k*t)))*sqrt(2./35.)*sqrt(k))/(9*(-1 + k**2)**8*t**4)

ovlp(1) = ovlp(1) + (-32*k**5*((-51840*k - 190080*k**3 - 17280*k*(3 + 11*k**2)*t + 2880*k*(-7 - 24*k**2 + 3*k**4)*t**2 &
                  + 2880*k*(-1 + k**2)*(1 + 3*k**2)*t**3 - 48*k*(-1 + k**2)**2*(3 + 7*k**2)*t**4)*exp(-t) + (51840*k &
                  + 190080*k**3 + 17280*k**2*(3 + 11*k**2)*t + 5760*k*(-1 + 15*k**4)*t**2 + 5760*k**2*(-1 + k**2)*(1 &
                  + 4*k**2)*t**3 + 96*k*(-1 + k**2)**2*(9 + 41*k**2)*t**4 + 6*(-1 + k**2)**3*(7 + 73*k**2)*t**5 + 30*k*(-1 &
                  + k**2)**4*t**6 + (-1 + k**2)**5*t**7)*exp(-(k*t)))*sqrt(2./105.)*sqrt(k))/(3*(-1 + k**2)**8*t**4)

endif

end select

! ------------------------------ n1 = 4 and n2 = 3 -----------------------------
  case(11) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((11025 + 11025*t + 5250*t**2 + 1575*t**3 + 336*t**4 + 56*t**5 + 8*t**6 &
                  + t**7)*exp(-t)*sqrt(2./7.))/6300 
else
ovlp(0) = ovlp(0) + (32*k**4*((-336 - 8112*k**2 - 15408*k**4 - 3024*k**6 + 6*(-1 + k**2)*(21 + 393*k**2 &
                  + 511*k**4 + 35*k**6)*t - 6*(-1 + k**2)**2*(3 + 42*k**2 + 35*k**4)*t**2 + (-1 + k**2)**3*(1 &
                  + 10*k**2 + 5*k**4)*t**3)*exp(-t) + (336 + 8112*k**2 + 15408*k**4 + 3024*k**6 + 192*k*(-1 &
                  + k**2)*(7 + 26*k**2 + 7*k**4)*t + 12*(-1 + k**2)**2*(5 + 54*k**2 + 21*k**4)*t**2 + 8*k*(-1 &
                  + k**2)**3*(5 + 3*k**2)*t**3 + (-1 + k**2)**4*(1 &
                  + k**2)*t**4)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/(15*(-1 + k**2)**8*t)
endif

!*******************
case(1)   ! <s1|p2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-1575*t**2 - 1575*t**3 - 861*t**4 - 336*t**5 - 96*t**6 - 19*t**7 - 3*t**8)*&
                    exp(-t)*sqrt(2./21.))/(6300*t)
else
ovlp(0) = ovlp(0) + (-32*k**4*((-1296 - 29232*k**2 - 47088*k**4 - 3024*k**6 - 144*(9 + 203*k**2 + 327*k**4 &
                  + 21*k**6)*t + 12*(-1 + k**2)*(33 + 609*k**2 + 763*k**4 + 35*k**6)*t**2 - 18*(-1 + k**2)**2*(3 &
                  + 42*k**2 + 35*k**4)*t**3 + 3*(-1 + k**2)**3*(1 + 10*k**2 + 5*k**4)*t**4)*exp(-t) + (1296 &
                  + 29232*k**2 + 47088*k**4 + 3024*k**6 + 144*k*(9 + 203*k**2 + 327*k**4 + 21*k**6)*t + 12*(-1 &
                  + k**2)*(21 + 609*k**2 + 1199*k**4 + 91*k**6)*t**2 + 12*k*(-1 + k**2)**2*(49 + 174*k**2 &
                  + 17*k**4)*t**3 + 3*(-1 + k**2)**3*(5 + 52*k**2 + 7*k**4)*t**4 + k*(-1 + k**2)**4*(5 &
                  + k**2)*t**5)*exp(-(k*t)))*sqrt(2./21.)*sqrt(k))/(15*(-1 + k**2)**8*t**2)
endif

!*******************
case(2)   ! <s1|d2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-105*t**3 - 105*t**4 - 36*t**5 - t**6 + 3*t**7 + t**8)*exp(-t)*sqrt(2./35.))/(1260*t)
else
ovlp(0) = ovlp(0) + (32*k**4*((-1440 - 31680*k**2 - 47520*k**4 - 1440*(1 + 22*k**2 + 33*k**4)*t + 48*(-13 &
                  - 271*k**2 - 339*k**4 + 63*k**6)*t**2 + 144*(-1 + k**2)*(1 + 18*k**2 + 21*k**4)*t**3 - 6*(-1 &
                  + k**2)**2*(3 + 42*k**2 + 35*k**4)*t**4 + (-1 + k**2)**3*(1 + 10*k**2 + 5*k**4)*t**5)*exp(-t) &
                  + (1440 + 31680*k**2 + 47520*k**4 + 1440*k*(1 + 22*k**2 + 33*k**4)*t + 96*(-1 - 22*k**2 + 87*k**4 &
                  + 216*k**6)*t**2 + 96*k*(-1 + k**2)*(1 + 28*k**2 + 51*k**4)*t**3 + 6*(-1 + k**2)**2*(1 + 46*k**2 &
                  + 113*k**4)*t**4 + 2*k*(-1 + k**2)**3*(5 + 27*k**2)*t**5 + 2*k**2*(-1 &
                  + k**2)**4*t**6)*exp(-(k*t)))*sqrt(2./35.)*sqrt(k))/(3*(-1 + k**2)**8*t**3)
endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(1575 + 1575*t + 735*t**2 + 210*t**3 + 42*t**4 + 7*t**5 + t**6)*exp(-t)*sqrt(2./21.))/2100
else
ovlp(0) = ovlp(0) + (32*k**4*((-4320*k - 18240*k**3 - 4320*k**5 - 480*k*(9 + 38*k**2 + 9*k**4)*t + 96*k*(-1 &
                  + k**2)*(12 + 41*k**2 + 7*k**4)*t**2 - 4*k*(-1 + k**2)**2*(33 + 82*k**2 + 5*k**4)*t**3 &
                  + 2*k*(-1 + k**2)**3*(3 + 5*k**2)*t**4)*exp(-t) + (4320*k + 18240*k**3 + 4320*k**5 + 480*k**2*(9 &
                  + 38*k**2 + 9*k**4)*t + 48*k*(-1 + k**2)*(21 + 108*k**2 + 31*k**4)*t**2 + 2*(-1 + k**2)**2*(25 &
                  + 326*k**2 + 129*k**4)*t**3 + 8*k*(-1 + k**2)**3*(5 + 3*k**2)*t**4 + (-1 + k**2)**4*(1 &
                  + k**2)*t**5)*exp(-(k*t)))*sqrt(2./21.)*sqrt(k))/(5*(-1 + k**2)**8*t**2)
endif

!*********************************
case(4)   ! l1 = l2 = 1 => <p1|p2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((11025*t + 11025*t**2 + 4410*t**3 + 735*t**4 - 60*t**5 - 60*t**6 - 16*t**7 & 
                  - 3*t**8)*exp(-t)*sqrt(2./7.))/(6300*t)
ovlp(1) = ovlp(1) - ((-11025*t - 11025*t**2 - 5145*t**3 - 1470*t**4 - 282*t**5 - 37*t**6 - 3*t**7)*&
                    exp(-t)*sqrt(2./7.))/(6300*t)
else
ovlp(0) = ovlp(0) + (-32*k**4*((-31680*k - 120960*k**3 - 8640*k**5 - 2880*k*(11 + 42*k**2 + 3*k**4)*t - 1440*k*(11 &
                  + 42*k**2 + 3*k**4)*t**2 + 240*k*(-1 + k**2)*(15 + 50*k**2 + 7*k**4)*t**3 - 12*k*(-1 + k**2)**2*(33 &
                  + 82*k**2 + 5*k**4)*t**4 + 6*k*(-1 + k**2)**3*(3 + 5*k**2)*t**5)*exp(-t) + (31680*k + 120960*k**3 &
                  + 8640*k**5 + 2880*k**2*(11 + 42*k**2 + 3*k**4)*t + 1440*k**3*(11 + 42*k**2 + 3*k**4)*t**2 + 30*(-1 &
                  + k**2)*(7 + 203*k**2 + 517*k**4 + 41*k**6)*t**3 + 6*k*(-1 + k**2)**2*(91 + 354*k**2 &
                  + 35*k**4)*t**4 + 3*(-1 + k**2)**3*(5 + 52*k**2 + 7*k**4)*t**5 + k*(-1 + k**2)**4*(5 &
                  + k**2)*t**6)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/(15*(-1 + k**2)**8*t**3)

ovlp(1) = ovlp(1) + (32*k**4*((-15840*k - 60480*k**3 - 4320*k**5 - 1440*k*(11 + 42*k**2 + 3*k**4)*t + 96*k*(-1 &
                  + k**2)*(42 + 131*k**2 + 7*k**4)*t**2 - 144*k*(-1 + k**2)**2*(3 + 7*k**2)*t**3 + 6*k*(-1 &
                  + k**2)**3*(3 + 5*k**2)*t**4)*exp(-t) + (15840*k + 60480*k**3 + 4320*k**5 + 1440*k**2*(11 &
                  + 42*k**2 + 3*k**4)*t + 48*k*(-1 + k**2)*(81 + 368*k**2 + 31*k**4)*t**2 + 6*(-1 + k**2)**2*(35 &
                  + 402*k**2 + 43*k**4)*t**3 + 24*k*(-1 + k**2)**3*(7 + k**2)*t**4 + (-1 + k**2)**4*(5 &
                  + k**2)*t**5)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/(15*(-1 + k**2)**8*t**3)

endif

!***************************************
case(5)   ! l1 = 1 and l2 = 2 => <p1|d2>
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-630*t**2 - 630*t**3 - 285*t**4 - 75*t**5 - 9*t**6 + 2*t**7 + t**8)*exp(-t)*sqrt(2./105.))/(420*t)
ovlp(1) = ovlp(1) - ((315*t**2 + 315*t**3 + 150*t**4 + 45*t**5 + 9*t**6 + t**7)*exp(-t)*sqrt(2./35.))/(420*t)
else
ovlp(0) = ovlp(0) + (64*k**4*((-25920*k - 95040*k**3 - 8640*k*(3 + 11*k**2)*t + 240*k*(-51 - 182*k**2 &
                  + 9*k**4)*t**2 + 240*k*(-15 - 50*k**2 + 9*k**4)*t**3 + 24*k*(-1 + k**2)*(27 + 86*k**2 &
                  + 7*k**4)*t**4 - 2*k*(-1 + k**2)**2*(33 + 82*k**2 + 5*k**4)*t**5 + k*(-1 + k**2)**3*(3 &
                  + 5*k**2)*t**6)*exp(-t) + (25920*k + 95040*k**3 + 8640*k**2*(3 + 11*k**2)*t + 240*k*(-3 &
                  + 38*k**2 + 189*k**4)*t**2 + 240*k**2*(-3 + 2*k**2 + 57*k**4)*t**3 + 24*k*(-1 + k**2)*(3 &
                  + 44*k**2 + 113*k**4)*t**4 + 4*(-1 + k**2)**2*(1 + 3*k**2)*(1 + 29*k**2)*t**5 + k*(-1 &
                  + k**2)**3*(5 + 27*k**2)*t**6 + k**2*(-1 + k**2)**4*t**7)*exp(-(k*t)))*sqrt(2./105.)*sqrt(k))/((-1 &
                  + k**2)**8*t**4)

ovlp(1) = ovlp(1) + (-64*k**4*((-8640*k - 31680*k**3 - 2880*k*(3 + 11*k**2)*t + 240*k*(-15 - 50*k**2 + 9*k**4)*t**2 &
                  + 720*k*(-1 + k**2)*(1 + 3*k**2)*t**3 - 24*k*(-1 + k**2)**2*(3 + 7*k**2)*t**4 + k*(-1 + k**2)**3*(3 &
                  + 5*k**2)*t**5)*exp(-t) + (8640*k + 31680*k**3 + 2880*k**2*(3 + 11*k**2)*t + 240*k*(-3 + 2*k**2 &
                  + 57*k**4)*t**2 + 240*k**2*(-1 + k**2)*(3 + 13*k**2)*t**3 + 24*k*(-1 + k**2)**2*(3 + 17*k**2)*t**4 &
                + 2*(-1 + k**2)**3*(1 + 15*k**2)*t**5 + k*(-1 + k**2)**4*t**6)*exp(-(k*t)))*sqrt(2./35.)*sqrt(k))/((-1 &
                  + k**2)**8*t**4)

endif

!********************
case(6)   ! <d1|s2>
!********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(105 + 105*t + 54*t**2 + 19*t**3 + 5*t**4 + t**5)*exp(-t)*sqrt(2./35.))/1260
else
ovlp(0) = ovlp(0) + (32*k**4*((-4320 - 60480*k**2 - 15840*k**4 - 1440*(3 + 42*k**2 + 11*k**4)*t + 96*(-19 &
                  - 253*k**2 - 17*k**4 + 9*k**6)*t**2 + 96*(-1 + k**2)*(4 + 47*k**2 + 9*k**4)*t**3 - 6*(-1 &
                  + k**2)**2*(7 + 66*k**2 + 7*k**4)*t**4 + 2*(-1 + k**2)**3*(1 + 7*k**2)*t**5)*exp(-t) + (4320 &
                  + 60480*k**2 + 15840*k**4 + 1440*k*(3 + 42*k**2 + 11*k**4)*t + 48*(-7 - 79*k**2 + 499*k**4 &
                  + 147*k**6)*t**2 + 48*k*(-1 + k**2)*(7 + 116*k**2 + 37*k**4)*t**3 + 30*(-1 + k**2)**2*(1 + 22*k**2 &
                  + 9*k**4)*t**4 + 8*k*(-1 + k**2)**3*(5 + 3*k**2)*t**5 + (-1 + k**2)**4*(1 &
                  + k**2)*t**6)*exp(-(k*t)))*sqrt(2./35.)*sqrt(k))/(3*(-1 + k**2)**8*t**3)

endif

!*********************
case(7)  ! <d1|p2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((3150*t**2 + 3150*t**3 + 1281*t**4 + 231*t**5 - 3*t**6 - 10*t**7 - 3*t**8)*exp(-t)*&
                    sqrt(2./105.))/(1260*t)
ovlp(1) = ovlp(1) + ((1575*t**2 + 1575*t**3 + 714*t**4 + 189*t**5 + 31*t**6 + 3*t**7)*exp(-t)*& 
                    sqrt(2./35.))/(1260*t)
else
ovlp(0) = ovlp(0) + (-32*k**4*((-47520 - 630720*k**2 - 47520*k**4 - 4320*(11 + 146*k**2 + 11*k**4)*t + 288*(-78 &
                  - 1021*k**2 - 24*k**4 + 3*k**6)*t**2 + 288*(-23 - 291*k**2 + 31*k**4 + 3*k**6)*t**3 + 6*(-1 &
                  + k**2)*(201 + 2325*k**2 + 347*k**4 + 7*k**6)*t**4 - 18*(-1 + k**2)**2*(7 + 66*k**2 + 7*k**4)*t**5 &
                  + 6*(-1 + k**2)**3*(1 + 7*k**2)*t**6)*exp(-t) + (47520 + 630720*k**2 + 47520*k**4 + 4320*k*(11 &
                  + 146*k**2 + 11*k**4)*t + 144*(-9 + 17*k**2 + 2073*k**4 + 159*k**6)*t**2 + 144*k*(-9 - 93*k**2 &
                  + 613*k**4 + 49*k**6)*t**3 + 6*(-1 + k**2)*(21 + 609*k**2 + 2959*k**4 + 251*k**6)*t**4 + 6*k*(-1 &
                  + k**2)**2*(77 + 366*k**2 + 37*k**4)*t**5 + 3*(-1 + k**2)**3*(5 + 52*k**2 + 7*k**4)*t**6 + k*(-1 &
                  + k**2)**4*(5 + k**2)*t**7)*exp(-(k*t)))*sqrt(2./105.)*sqrt(k))/(3*(-1 + k**2)**8*t**4)
 
ovlp(1) = ovlp(1) + (32*k**4*((-15840 - 210240*k**2 - 15840*k**4 - 1440*(11 + 146*k**2 + 11*k**4)*t + 288*(-23 &
                  - 291*k**2 + 31*k**4 + 3*k**6)*t**2 + 96*(-1 + k**2)*(14 + 157*k**2 + 9*k**4)*t**3 - 6*(-1 &
                  + k**2)**2*(23 + 210*k**2 + 7*k**4)*t**4 + 6*(-1 + k**2)**3*(1 + 7*k**2)*t**5)*exp(-t) + (15840 &
                  + 210240*k**2 + 15840*k**4 + 1440*k*(11 + 146*k**2 + 11*k**4)*t + 144*(-9 - 93*k**2 + 613*k**4 &
                  + 49*k**6)*t**2 + 48*k*(-1 + k**2)*(27 + 416*k**2 + 37*k**4)*t**3 + 18*(-1 + k**2)**2*(7 &
                  + 138*k**2 + 15*k**4)*t**4 + 24*k*(-1 + k**2)**3*(7 + k**2)*t**5 + (-1 + k**2)**4*(5 &
                  + k**2)*t**6)*exp(-(k*t)))*sqrt(2./35.)*sqrt(k))/(3*(-1 + k**2)**8*t**4)

endif

!*********************
case(8)  ! <d1|d2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((2205*t + 2205*t**2 + 690*t**3 - 45*t**4 - 84*t**5 - 20*t**6 + t**8)*exp(-t)*sqrt(2./7.))/(1260*t)
ovlp(1) = ovlp(1) - ((-735*t - 735*t**2 - 255*t**3 - 10*t**4 + 20*t**5 + 7*t**6 + t**7)*exp(-t)*sqrt(2./7.))/(420*t)
ovlp(2) = ovlp(2) + ((735*t + 735*t**2 + 330*t**3 + 85*t**4 + 13*t**5 + t**6)*exp(-t)*sqrt(2./7.))/(420*t)
else
ovlp(0) = ovlp(0) + (64*k**4*((-51840 - 673920*k**2 - 51840*(1 + 13*k**2)*t + 1440*(-17 - 218*k**2 + 11*k**4)*t**2 &
                  + 1440*(-5 - 62*k**2 + 11*k**4)*t**3 - 48*(31 + 367*k**2 - 127*k**4 + 9*k**6)*t**4 + 3*(-1 &
                  + k**2)*(73 + 821*k**2 + 59*k**4 + 7*k**6)*t**5 - 3*(-1 + k**2)**2*(7 + 66*k**2 + 7*k**4)*t**6 &
                  + (-1 + k**2)**3*(1 + 7*k**2)*t**7)*exp(-t) + (51840 + 673920*k**2 + 51840*k*(1 + 13*k**2)*t &
                  + 1440*(-1 + 2*k**2 + 223*k**4)*t**2 + 1440*k*(-1 - 10*k**2 + 67*k**4)*t**3 + 48*(1 + 7*k**2 &
                  - 157*k**4 + 429*k**6)*t**4 + 120*k*(-1 + k**2)*(1 + 4*k**2 + 27*k**4)*t**5 + 6*(-1 + k**2)**2*(1 &
                  + 18*k**2 + 61*k**4)*t**6 + k*(-1 + k**2)**3*(5 + 27*k**2)*t**7 + k**2*(-1 &
                  + k**2)**4*t**8)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/(3*(-1 + k**2)**8*t**5)
 
ovlp(1) = ovlp(1) + (-64*k**4*((-11520 - 149760*k**2 - 11520*(1 + 13*k**2)*t + 480*(-11 - 140*k**2 + 11*k**4)*t**2 &
                  + 480*(-3 - 36*k**2 + 11*k**4)*t**3 + 240*(-1 + k**2)*(1 + 11*k**2)*t**4 - (-1 + k**2)**2*(23 &
                  + 210*k**2 + 7*k**4)*t**5 + (-1 + k**2)**3*(1 + 7*k**2)*t**6)*exp(-t) + (11520 + 149760*k**2 &
                  + 11520*k*(1 + 13*k**2)*t + 480*(-1 - 4*k**2 + 145*k**4)*t**2 + 480*k*(-1 - 12*k**2 + 41*k**4)*t**3 &
                  + 240*k**2*(-1 + k**2)*(1 + 15*k**2)*t**4 + 8*k*(-1 + k**2)**2*(7 + 53*k**2)*t**5 + 2*(-1 &
                  + k**2)**3*(1 + 15*k**2)*t**6 + k*(-1 + k**2)**4*t**7)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/((-1 &
                  + k**2)**8*t**5)

ovlp(2) = ovlp(2) + (64*k**4*((-2880 - 37440*k**2 - 2880*(1 + 13*k**2)*t + 240*(-5 - 62*k**2 + 11*k**4)*t**2 &
                  + 240*(-1 + k**2)*(1 + 11*k**2)*t**3 - 24*(-1 + k**2)**2*(1 + 9*k**2)*t**4 + (-1 + k**2)**3*(1 &
                  + 7*k**2)*t**5)*exp(-t) + (2880 + 37440*k**2 + 2880*k*(1 + 13*k**2)*t + 240*(-1 - 10*k**2 &
                  + 67*k**4)*t**2 + 240*k*(-1 + k**2)*(1 + 15*k**2)*t**3 + 24*(-1 + k**2)**2*(1 + 19*k**2)*t**4 &
               + 32*k*(-1 + k**2)**3*t**5 + (-1 + k**2)**4*t**6)*exp(-(k*t)))*sqrt(2./7.)*sqrt(k))/((-1 + k**2)**8*t**5)

endif

end select

! ------------------------------ n1 = n2 = 3 -----------------------------------
  case(10) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)  ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((1575 + 1575*t + 735*t**2 + 210*t**3 + 42*t**4 + 7*t**5 + t**6)*exp(-t))/1575
else
ovlp(0) = ovlp(0) + (64*k**3*((-336*k - 1248*k**3 - 336*k**5 + 6*k*(-1 + k**2)*(21 + 54*k**2 + 5*k**4)*t & 
         - 6*k*(-1 + k**2)**2*(3 + 5*k**2)*t**2 + k*(-1 + k**2)**3*(1 + k**2)*t**3)*exp(-t)  & 
         + (336*k + 1248*k**3 + 336*k**5 + 6*(-1 + k**2)*(5 + 54*k**2 + 21*k**4)*t + 6*k*(-1 + k**2)**2*(5 + 3*k**2)*t**2 &
         + (-1 + k**2)**3*(1 + k**2)*t**3)*exp(-(k*t)))*sqrt(k))/(15*(-1 + k**2)**7*t)
endif

!*****************************************
case(1,3)  ! l1 = 1 and l2 = 0  => <p1|s2> 
!*****************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(525 + 525*t + 252*t**2 + 77*t**3 + 17*t**4 + 3*t**5)*exp(-t))/(1575*sqrt(3.))
else
ovlp(0) = ovlp(0) + (64*k**3*((-336 - 4128*k**2 - 1296*k**4 - 48*(7 + 86*k**2 + 27*k**4)*t + &
                    36*(-1 + k**2)*(3 + 30*k**2 + 7*k**4)*t**2 - 2*(-1 + k**2)**2*(8 + 59*k**2 + 5*k**4)*t**3 + &
                    (-1 + k**2)**3*(1 + 5*k**2)*t**4)*exp(-t) + (336 + 4128*k**2 + 1296*k**4 + 48*k*(7 + 86*k**2 + &
                    27*k**4)*t + 12*(-1 + k**2)*(5 + 82*k**2 + 33*k**4)*t**2 + 18*k*(-1 + k**2)**2*(5 + 3*k**2)*t**3 + &
                    3*(-1 + k**2)**3*(1 + k**2)*t**4)*exp(-(k*t)))*sqrt(k))/(15*sqrt(3.)*(-1 + k**2)**7*t**2)
endif

!***************************************
case(2,6)  ! l1 = 2 and l2 = 0  => <d1|s2> 
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**4*(3 + 3*t + t**2)*exp(-t))/(315*sqrt(5.))
else
ovlp(0) = ovlp(0) + (64*k**3*((-4320*k - 1440*k**3 - 1440*k*(3 + k**2)*t + 96*k*(-19 - 2*k**2 + k**4)*t**2 &
                  + 96*k*(-1 + k**2)*(4 + k**2)*t**3 - 6*k*(-1 + k**2)**2*(7 + k**2)*t**4 &
                  + 2*k*(-1 + k**2)**3*t**5)*exp(-t) + (4320*k + 1440*k**3 + 1440*k**2*(3 + k**2)*t &
                  + 48*k*(-7 + 34*k**2 + 13*k**4)*t**2 + 48*k**2*(-1 + k**2)*(7 + 3*k**2)*t**3 &
                  + 6*k*(-1 + k**2)**2*(5 + 3*k**2)*t**4 + (-1 + k**2)**3*(1 + k**2)*t**5) &
                  *exp(-(k*t)))*sqrt(k))/(3*sqrt(5.)*(-1 + k**2)**7*t**3)
endif

!***************************************
case(4)  ! l1 = l2 = 1  => <p1|p2> 
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (( 1575*t + 1575*t**2 + 567*t**3 + 42*t**4 - 34*t**5 - 13*t**6 - 3*t**7)*exp(-t))/(1575*t)
ovlp(1) = ovlp(1) - ((-1575*t - 1575*t**2 - 714*t**3 - 189*t**4 - 31*t**5 - 3*t**6)*exp(-t))/(1575*t)
else
ovlp(0) = ovlp(0) + (-64*k**3*((-864 - 9792*k**2 - 864*k**4 - 288*(3 + 34*k**2 + 3*k**4)*t &
                  - 144*(3 + 34*k**2 + 3*k**4)*t**2 + 6*(-1 + k**2)*(19 + 186*k**2 + 35*k**4)*t**3 &
                  - 2*(-1 + k**2)**2*(8 + 59*k**2 + 5*k**4)*t**4 + (-1 + k**2)**3*(1 + 5*k**2)*t**5)*exp(-t) &
                  + (864 + 9792*k**2 + 864*k**4 + 288*k*(3 + 34*k**2 + 3*k**4)*t + 144*k**2*(3 + 34*k**2 &
                  + 3*k**4)*t**2 + 6*k*(-1 + k**2)*(35 + 186*k**2 + 19*k**4)*t**3 + 2*(-1 + k**2)**2*(5 + 59*k**2 &
                  + 8*k**4)*t**4 + k*(-1 + k**2)**3*(5 + k**2)*t**5)*exp(-(k*t)))*sqrt(k))/(15*(-1 + k**2)**7*t**3)

ovlp(1) = ovlp(1) + (64*k**3*((-432 - 4896*k**2 - 432*k**4 - 144*(3 + 34*k**2 + 3*k**4)*t &
                  + 12*(-1 + k**2)*(11 + 102*k**2 + 7*k**4)*t**2 - 18*(-1 + k**2)**2*(1 + 7*k**2)*t**3 &
                  + (-1 + k**2)**3*(1 + 5*k**2)*t**4)*exp(-t) + (432 + 4896*k**2 + 432*k**4 &
                  + 144*k*(3 + 34*k**2 + 3*k**4)*t + 12*(-1 + k**2)*(7 + 102*k**2 + 11*k**4)*t**2 &
                  + 18*k*(-1 + k**2)**2*(7 + k**2)*t**3 + (-1 + k**2)**3*(5 + k**2)*t**4)*exp(-(k*t)))*&
                    sqrt(k))/(15*(-1 + k**2)**7*t**3)
endif

!***************************************
case(5,7)  ! l1 = 2 and l2 = 1  => <d1|p2> 
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((420*t**2 + 420*t**3 + 162*t**4 + 22*t**5 - 5*t**6 - 3*t**7)*exp(-t))/(315*t*sqrt(15.))
ovlp(1) = ovlp(1) + ((210*t**2 + 210*t**3 + 93*t**4 + 23*t**5 + 3*t**6)*exp(-t))/(315*t*sqrt(5.))
else
ovlp(0) = ovlp(0) + (-64*k**3*((-47520*k - 4320*k**3 - 4320*k*(11 + k**2)*t + 96*k*(-234 - 7*k**2 + k**4)*t**2 &
                  + 96*k*(-69 + 8*k**2 + k**4)*t**3 + 6*k*(-1 + k**2)*(201 + 38*k**2 + k**4)*t**4 &
                  - 18*k*(-1 + k**2)**2*(7 + k**2)*t**5 + 6*k*(-1 + k**2)**3*t**6)*exp(-t) + (47520*k + 4320*k**3 &
                  + 4320*k**2*(11 + k**2)*t + 48*k*(-27 + 464*k**2 + 43*k**4)*t**2 + 48*k**2*(-27 + 134*k**2 &
                  + 13*k**4)*t**3 + 18*k*(-1 + k**2)*(7 + 66*k**2 + 7*k**4)*t**4 + 2*(-1 + k**2)**2*(5 + 59*k**2 &
                  + 8*k**4)*t**5 + k*(-1 + k**2)**3*(5 + k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(3*Sqrt(15.)*(-1 + k**2)**7*t**4)

ovlp(1) = ovlp(1) + (64*k**3*((-15840*k - 1440*k**3 - 1440*k*(11 + k**2)*t + 96*k*(-69 + 8*k**2 + k**4)*t**2 &
                  + 96*k*(-1 + k**2)*(14 + k**2)*t**3 - 6*k*(-1 + k**2)**2*(23 + k**2)*t**4 &
                  + 6*k*(-1 + k**2)**3*t**5)*exp(-t) + (15840*k + 1440*k**3 + 1440*k**2*(11 + k**2)*t &
                  + 48*k*(-27 + 134*k**2 + 13*k**4)*t**2 + 144*k**2*(-1 + k**2)*(9 + k**2)*t**3 &
                  + 18*k*(-1 + k**2)**2*(7 + k**2)*t**4 + (-1 + k**2)**3*(5 + k**2)*t**5)&
                  *exp(-(k*t)))*sqrt(k))/(3*Sqrt(5.)*(-1 + k**2)**7*t**4)
endif

!***************************************
case(8)  ! l1 = l2 = 2  => <d1|d2> 
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((315*t + 315*t**2 + 75*t**3 - 30*t**4 - 18*t**5 - t**6 + t**7)*exp(-t))/(315*t)
ovlp(1) = ovlp(1) - ((-105*t - 105*t**2 - 30*t**3 + 5*t**4 + 5*t**5 + t**6)*exp(-t))/(105*t)
ovlp(2) = ovlp(2) + ((105*t + 105*t**2 + 45*t**3 + 10*t**4 + t**5)*exp(-t))/(105*t)
else
ovlp(0) = ovlp(0) + (128*k**3*((-51840*k - 51840*k*t + 1440*k*(-17 + k**2)*t**2 + 1440*k*(-5 + k**2)*t**3 &
                  - 48*k*(31 - 12*k**2 + k**4)*t**4 + 3*k*(-1 + k**2)*(73 + 6*k**2 + k**4)*t**5 &
                  - 3*k*(-1 + k**2)**2*(7 + k**2)*t**6 + k*(-1 + k**2)**3*t**7)*exp(-t) + (51840*k &
                  + 51840*k**2*t + 1440*k*(-1 + 17*k**2)*t**2 + 1440*k**2*(-1 + 5*k**2)*t**3 + 48*k*(1 &
                  - 12*k**2 + 31*k**4)*t**4 + 3*(-1 + k**2)*(1 + 6*k**2 + 73*k**4)*t**5 + 3*k*(-1 + k**2)**2*(1 &
                  + 7*k**2)*t**6 + k**2*(-1 + k**2)**3*t**7)*exp(-(k*t)))*sqrt(k))/(3*(-1 + k**2)**7*t**5)

ovlp(1) = ovlp(1) + (-128*k**3*((-11520*k - 11520*k*t + 480*k*(-11 + k**2)*t**2 + 480*k*(-3 + k**2)*t**3 &
                  + 240*k*(-1 + k**2)*t**4 - k*(-1 + k**2)**2*(23 + k**2)*t**5 + k*(-1 + k**2)**3*t**6)*exp(-t) &
                  + (11520*k + 11520*k**2*t + 480*k*(-1 + 11*k**2)*t**2 + 480*k**2*(-1 + 3*k**2)*t**3 &
                  + 240*k**3*(-1 + k**2)*t**4 + (-1 + k**2)**2*(1 + 23*k**2)*t**5 &
                  + k*(-1 + k**2)**3*t**6)*exp(-(k*t)))*sqrt(k))/((-1 + k**2)**7*t**5)

ovlp(2) = ovlp(2) + (128*k**3*((-2880*k - 2880*k*t + 240*k*(-5 + k**2)*t**2 + 240*k*(-1 + k**2)*t**3 &
                  - 24*k*(-1 + k**2)**2*t**4 + k*(-1 + k**2)**3*t**5)*exp(-t) + (2880*k + 2880*k**2*t &
                  + 240*k*(-1 + 5*k**2)*t**2 + 240*k**2*(-1 + k**2)*t**3 + 24*k*(-1 + k**2)**2*t**4 &
                  + (-1 + k**2)**3*t**5)*exp(-(k*t)))*sqrt(k))/((-1 + k**2)**7*t**5)
endif


end select  

! ------------------------------ n1 = 5 and n2 = 3 -----------------------------
  case(12) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) +  ((79380 + 79380*t + 38745*t**2 + 12285*t**3 + 2835*t**4 + 504*t**5 + 72*t**6 + 9*t**7 &
                  + t**8)*exp(-t))/(17010*sqrt(35.))
else

ovlp(0) = ovlp(0) + (64*k**5*((-21600*k - 175200*k**3 - 203040*k**5 - 30240*k**7 + 240*k*(-1 + k**2)*(27 + 169*k**2 + 133*k**4 &
                  + 7*k**6)*t - 240*k*(-1 + k**2)**2*(3 + 14*k**2 + 7*k**4)*t**2 + 10*k*(-1 + k**2)**3*(3 + k**2)*(1 &
                  + 3*k**2)*t**3)*exp(-t) + (21600*k + 175200*k**3 + 203040*k**5 + 30240*k**7 + 240*(-1 + k**2)*(7 + 169*k**2 &
                  + 321*k**4 + 63*k**6)*t + 480*k*(-1 + k**2)**2*(7 + 26*k**2 + 7*k**4)*t**2 + 20*(-1 + k**2)**3*(5 + 54*k**2 &
                  + 21*k**4)*t**3 + 10*k*(-1 + k**2)**4*(5 + 3*k**2)*t**4 + (-1 + k**2)**5*(1 &
                  + k**2)*t**5)*exp(-(k*t)))*sqrt(k))/(45*sqrt(35.)*(-1 + k**2)**9*t)

endif

!*******************
case(1)   ! <s1|p2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-315*t**4 - 315*t**5 - 144*t**6 - 39*t**7 - 7*t**8 - t**9)*exp(-t))/(5670*t*sqrt(105.))

else

ovlp(0) = ovlp(0) + (-64*k**5*((-79200*k - 597600*k**3 - 583200*k**5 - 30240*k**7 - 1440*k*(55 + 415*k**2 + 405*k**4 &
                  + 21*k**6)*t + 3360*k*(-1 + k**2)*(6 + 37*k**2 + 28*k**4 + k**6)*t**2 - 720*k*(-1 + k**2)**2*(3 &
                  + 14*k**2 + 7*k**4)*t**3 + 30*k*(-1 + k**2)**3*(3 + k**2)*(1 + 3*k**2)*t**4)*exp(-t) + (79200*k &
                  + 597600*k**3 + 583200*k**5 + 30240*k**7 + 1440*k**2*(55 + 415*k**2 + 405*k**4 + 21*k**6)*t + 240*k*(-1 &
                  + k**2)*(81 + 727*k**2 + 823*k**4 + 49*k**6)*t**2 + 120*(-1 + k**2)**2*(7 + 167*k**2 + 285*k**4 &
                  + 21*k**6)*t**3 + 30*k*(-1 + k**2)**3*(35 + 114*k**2 + 11*k**4)*t**4 + 2*(-1 + k**2)**4*(10 + 97*k**2 &
                  + 13*k**4)*t**5 + k*(-1 + k**2)**5*(5 + k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(45*sqrt(105.)*(-1 + k**2)**9*t**2)

endif

!*******************
case(2)   ! <s1|d2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-945*t**3 - 945*t**4 - 405*t**5 - 90*t**6 - 6*t**7 + 3*t**8 + t**9)*exp(-t))/(17010*t*sqrt(7.))

else

ovlp(0) = ovlp(0) + (128*k**5*((-43200*k - 316800*k**3 - 285120*k**5 - 2880*k*(15 + 110*k**2 + 99*k**4)*t + 240*k*(-75 &
                  - 515*k**2 - 369*k**4 + 63*k**6)*t**2 + 720*k*(-1 + k**2)*(5 + 30*k**2 + 21*k**4)*t**3 - 120*k*(-1 &
                  + k**2)**2*(3 + 14*k**2 + 7*k**4)*t**4 + 5*k*(-1 + k**2)**3*(3 + k**2)*(1 + 3*k**2)*t**5)*exp(-t) &
                  + (43200*k + 316800*k**3 + 285120*k**5 + 2880*k**2*(15 + 110*k**2 + 99*k**4)*t + 240*k*(-15 - 55*k**2 &
                  + 435*k**4 + 531*k**6)*t**2 + 1200*k**2*(-1 + k**2)*(3 + 26*k**2 + 27*k**4)*t**3 + 120*k*(-1 + k**2)**2*(3 &
                  + 34*k**2 + 43*k**4)*t**4 + 8*(-1 + k**2)**3*(1 + 33*k**2 + 66*k**4)*t**5 + k*(-1 + k**2)**4*(7 &
                  + 33*k**2)*t**6 + k**2*(-1 + k**2)**5*t**7)*exp(-(k*t)))*sqrt(k))/(45*sqrt(7.)*(-1 + k**2)**9*t**3)

endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(66150 + 66150*t + 31185*t**2 + 9135*t**3 + 1872*t**4 + 297*t**5 + 41*t**6 &
                  + 5*t**7)*exp(-t))/(28350*sqrt(105.))
else

ovlp(0) = ovlp(0) + (64*k**5*((-4320 - 119520*k**2 - 258720*k**4 - 47520*k**6 - 480*(9 + 249*k**2 + 539*k**4 + 99*k**6)*t &
                  + 288*(-1 + k**2)*(4 + 93*k**2 + 162*k**4 + 21*k**6)*t**2 - 4*(-1 + k**2)**2*(33 + 609*k**2 + 763*k**4 &
                  + 35*k**6)*t**3 + 2*(-1 + k**2)**3*(3 + 42*k**2 + 35*k**4)*t**4)*exp(-t) + (4320 + 119520*k**2 + 258720*k**4 &
                  + 47520*k**6 + 480*k*(9 + 249*k**2 + 539*k**4 + 99*k**6)*t + 48*(-1 + k**2)*(21 + 687*k**2 + 1723*k**4 &
                  + 369*k**6)*t**2 + 32*k*(-1 + k**2)**2*(91 + 398*k**2 + 111*k**4)*t**3 + 2*(-1 + k**2)**3*(45 + 542*k**2 &
                  + 213*k**4)*t**4 + 10*k*(-1 + k**2)**4*(5 + 3*k**2)*t**5 + (-1 + k**2)**5*(1 &
                  + k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(15*sqrt(105.)*(-1 + k**2)**9*t**2)

endif

!*********************************
case(4)   ! l1 = l2 = 1 => <p1|p2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((132300*t + 132300*t**2 + 57645*t**3 + 13545*t**4 + 1305*t**5 - 270*t**6 - 142*t**7 &
                  - 31*t**8 - 5*t**9)*exp(-t))/(28350*t*sqrt(35.))
ovlp(1) = ovlp(1) - ((-132300*t - 132300*t**2 - 63315*t**3 - 19215*t**4 - 4104*t**5 - 639*t**6 - 71*t**7 &
                  - 5*t**8)*exp(-t))/(28350*t*sqrt(35.))
else

ovlp(0) = ovlp(0) + (-64*k**5*((-31680 - 838080*k**2 - 1615680*k**4 - 95040*k**6 - 2880*(11 + 291*k**2 + 561*k**4 + 33*k**6)*t &
                  - 1440*(11 + 291*k**2 + 561*k**4 + 33*k**6)*t**2 + 720*(-1 + k**2)*(5 + 115*k**2 + 195*k**4 + 21*k**6)*t**3 &
                  - 12*(-1 + k**2)**2*(33 + 609*k**2 + 763*k**4 + 35*k**6)*t**4 + 6*(-1 + k**2)**3*(3 + 42*k**2 &
                  + 35*k**4)*t**5)*exp(-t) + (31680 + 838080*k**2 + 1615680*k**4 + 95040*k**6 + 2880*k*(11 + 291*k**2 + 561*k**4 &
                  + 33*k**6)*t + 1440*k**2*(11 + 291*k**2 + 561*k**4 + 33*k**6)*t**2 + 240*k*(-1 + k**2)*(63 + 629*k**2 &
                  + 929*k**4 + 59*k**6)*t**3 + 36*(-1 + k**2)**2*(21 + 513*k**2 + 991*k**4 + 75*k**6)*t**4 + 48*k*(-1 &
                  + k**2)**3*(21 + 72*k**2 + 7*k**4)*t**5 + 2*(-1 + k**2)**4*(10 + 97*k**2 + 13*k**4)*t**6 + k*(-1 + k**2)**5*(5 &
                  + k**2)*t**7)*exp(-(k*t)))*sqrt(k))/(45*sqrt(35.)*(-1 + k**2)**9*t**3)

ovlp(1) = ovlp(1) + (64*k**5*((-15840 - 419040*k**2 - 807840*k**4 - 47520*k**6 - 1440*(11 + 291*k**2 + 561*k**4 + 33*k**6)*t &
                + 288*(-1 + k**2)*(14 + 313*k**2 + 492*k**4 + 21*k**6)*t**2 - 432*(-1 + k**2)**2*(1 + 18*k**2 + 21*k**4)*t**3 &
                + 6*(-1 + k**2)**3*(3 + 42*k**2 + 35*k**4)*t**4)*exp(-t) + (15840 + 419040*k**2 + 807840*k**4 + 47520*k**6 &
                + 1440*k*(11 + 291*k**2 + 561*k**4 + 33*k**6)*t + 144*(-1 + k**2)*(27 + 829*k**2 + 1821*k**4 + 123*k**6)*t**2 &
                + 96*k*(-1 + k**2)**2*(117 + 446*k**2 + 37*k**4)*t**3 + 6*(-1 + k**2)**3*(63 + 666*k**2 + 71*k**4)*t**4 &
                + 30*k*(-1 + k**2)**4*(7 + k**2)*t**5 + (-1 + k**2)**5*(5 + k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(45*sqrt(35.)*(-1 &
                + k**2)**9*t**3)

endif

!***************************************
case(5)   ! l1 = 1 and l2 = 2 => <p1|d2>
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-13230*t**2 - 13230*t**3 - 6885*t**4 - 2475*t**5 - 594*t**6 - 63*t**7 + 11*t**8 &
                  + 5*t**9)*exp(-t))/(28350*t*sqrt(21.))
ovlp(1) = ovlp(1) - ((6615*t**2 + 6615*t**3 + 3375*t**4 + 1170*t**5 + 294*t**6 + 51*t**7 &
                  + 5*t**8)*exp(-t))/(28350*t*sqrt(7.))
else

ovlp(0) = ovlp(0) + (128*k**5*((-25920 - 673920*k**2 - 1235520*k**4 - 8640*(3 + 78*k**2 + 143*k**4)*t + 240*(-51 - 1311*k**2 &
                  - 2321*k**4 + 99*k**6)*t**2 + 240*(-15 - 375*k**2 - 605*k**4 + 99*k**6)*t**3 + 72*(-1 + k**2)*(9 + 203*k**2 &
                  + 327*k**4 + 21*k**6)*t**4 - 2*(-1 + k**2)**2*(33 + 609*k**2 + 763*k**4 + 35*k**6)*t**5 + (-1 + k**2)**3*(3 &
                  + 42*k**2 + 35*k**4)*t**6)*exp(-t) + (25920 + 673920*k**2 + 1235520*k**4 + 8640*k*(3 + 78*k**2 + 143*k**4)*t &
                  + 240*(-3 - 39*k**2 + 1151*k**4 + 2475*k**6)*t**2 + 240*k*(-3 - 75*k**2 + 215*k**4 + 759*k**6)*t**3 + 24*(-1 &
                  + k**2)*(3 + 141*k**2 + 1069*k**4 + 1587*k**6)*t**4 + 8*k*(-1 + k**2)**2*(47 + 466*k**2 + 687*k**4)*t**5 + (-1 &
                  + k**2)**3*(9 + 254*k**2 + 537*k**4)*t**6 + k*(-1 + k**2)**4*(7 + 33*k**2)*t**7 + k**2*(-1 &
                  + k**2)**5*t**8)*exp(-(k*t)))*sqrt(k))/(15*sqrt(21.)*(-1 + k**2)**9*t**4)

ovlp(1) = ovlp(1) + (-128*k**5*((-8640 - 224640*k**2 - 411840*k**4 - 2880*(3 + 78*k**2 + 143*k**4)*t + 240*(-15 - 375*k**2 &
                  - 605*k**4 + 99*k**6)*t**2 + 720*(-1 + k**2)*(1 + 22*k**2 + 33*k**4)*t**3 - 72*(-1 + k**2)**2*(1 + 18*k**2 &
                  + 21*k**4)*t**4 + (-1 + k**2)**3*(3 + 42*k**2 + 35*k**4)*t**5)*exp(-t) + (8640 + 224640*k**2 + 411840*k**4 &
                  + 2880*k*(3 + 78*k**2 + 143*k**4)*t + 240*(-3 - 75*k**2 + 215*k**4 + 759*k**6)*t**2 + 240*k*(-1 + k**2)*(3 &
                  + 90*k**2 + 187*k**4)*t**3 + 24*(-1 + k**2)**2*(3 + 114*k**2 + 283*k**4)*t**4 + 8*k*(-1 + k**2)**3*(19 &
                  + 81*k**2)*t**5 + (-1 + k**2)**4*(3 + 37*k**2)*t**6 + k*(-1 &
                  + k**2)**5*t**7)*exp(-(k*t)))*sqrt(k))/(15*sqrt(7.)*(-1 + k**2)**9*t**4)

endif

!********************
case(6)   ! <d1|s2>
!********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(6615 + 6615*t + 3105*t**2 + 900*t**3 + 186*t**4 + 33*t**5 + 5*t**6)*exp(-t))/(85050*sqrt(7.))

else

ovlp(0) = ovlp(0) + (64*k**5*((-190080*k - 910080*k**3 - 190080*k**5 - 5760*k*(33 + 158*k**2 + 33*k**4)*t + 960*k*(-81 &
                  - 361*k**2 - 15*k**4 + 9*k**6)*t**2 + 2880*k*(-1 + k**2)*(5 + 20*k**2 + 3*k**4)*t**3 - 48*k*(-1 &
                  + k**2)**2*(27 + 86*k**2 + 7*k**4)*t**4 + 16*k*(-1 + k**2)**3*(3 + 7*k**2)*t**5)*exp(-t) + (190080*k &
                  + 910080*k**3 + 190080*k**5 + 5760*k**2*(33 + 158*k**2 + 33*k**4)*t + 1920*k*(-9 - 7*k**2 + 195*k**4 &
                  + 45*k**6)*t**2 + 1920*k**2*(-1 + k**2)*(9 + 49*k**2 + 12*k**4)*t**3 + 96*k*(-1 + k**2)**2*(21 + 138*k**2 &
                  + 41*k**4)*t**4 + 2*(-1 + k**2)**3*(35 + 546*k**2 + 219*k**4)*t**5 + 10*k*(-1 + k**2)**4*(5 + 3*k**2)*t**6 &
                  + (-1 + k**2)**5*(1 + k**2)*t**7)*exp(-(k*t)))*sqrt(k))/(45*sqrt(7.)*(-1 + k**2)**9*t**3)

endif

!*********************
case(7)  ! <d1|p2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((39690*t**2 + 39690*t**3 + 17055*t**4 + 3825*t**5 + 342*t**6 - 51*t**7 - 23*t**8 &
                  - 5*t**9)*exp(-t))/(28350*t*sqrt(21.))
ovlp(1) = ovlp(1) + ((19845*t**2 + 19845*t**3 + 9225*t**4 + 2610*t**5 + 492*t**6 + 63*t**7 + 5*t**8)*exp(-t))/(28350*t*sqrt(7.))

else

ovlp(0) = ovlp(0) + (-64*k**5*((-2021760*k - 9020160*k**3 - 570240*k**5 - 51840*k*(39 + 174*k**2 + 11*k**4)*t + 2880*k*(-329 &
                  - 1439*k**2 - 27*k**4 + 3*k**6)*t**2 + 2880*k*(-95 - 395*k**2 + 39*k**4 + 3*k**6)*t**3 + 48*k*(-1 + k**2)*(933 &
                  + 3661*k**2 + 439*k**4 + 7*k**6)*t**4 - 144*k*(-1 + k**2)**2*(27 + 86*k**2 + 7*k**4)*t**5 + 48*k*(-1 &
                  + k**2)**3*(3 + 7*k**2)*t**6)*exp(-t) + (2021760*k + 9020160*k**3 + 570240*k**5 + 51840*k**2*(39 + 174*k**2 &
                  + 11*k**4)*t + 5760*k*(-11 + 112*k**2 + 747*k**4 + 48*k**6)*t**2 + 5760*k**2*(-11 - 5*k**2 + 225*k**4 &
                  + 15*k**6)*t**3 + 96*k*(-1 + k**2)*(81 + 1057*k**2 + 2863*k**4 + 199*k**6)*t**4 + 12*(-1 + k**2)**2*(49 &
                  + 1277*k**2 + 3219*k**4 + 255*k**6)*t**5 + 12*k*(-1 + k**2)**3*(77 + 294*k**2 + 29*k**4)*t**6 + 2*(-1 &
                  + k**2)**4*(10 + 97*k**2 + 13*k**4)*t**7 + k*(-1 + k**2)**5*(5 &
                  + k**2)*t**8)*exp(-(k*t)))*sqrt(k))/(45*sqrt(21.)*(-1 + k**2)**9*t**4)
 
ovlp(1) = ovlp(1) + (64*k**5*((-673920*k - 3006720*k**3 - 190080*k**5 - 17280*k*(39 + 174*k**2 + 11*k**4)*t + 2880*k*(-95 &
                  - 395*k**2 + 39*k**4 + 3*k**6)*t**2 + 2880*k*(-1 + k**2)*(17 + 64*k**2 + 3*k**4)*t**3 - 48*k*(-1 &
                  + k**2)**2*(87 + 266*k**2 + 7*k**4)*t**4 + 48*k*(-1 + k**2)**3*(3 + 7*k**2)*t**5)*exp(-t) + (673920*k &
                  + 3006720*k**3 + 190080*k**5 + 17280*k**2*(39 + 174*k**2 + 11*k**4)*t + 5760*k*(-11 - 5*k**2 + 225*k**4 &
                  + 15*k**6)*t**2 + 5760*k**2*(-1 + k**2)*(11 + 55*k**2 + 4*k**4)*t**3 + 96*k*(-1 + k**2)**2*(81 + 478*k**2 &
                  + 41*k**4)*t**4 + 6*(-1 + k**2)**3*(49 + 678*k**2 + 73*k**4)*t**5 + 30*k*(-1 + k**2)**4*(7 + k**2)*t**6 + (-1 &
                  + k**2)**5*(5 + k**2)*t**7)*exp(-(k*t)))*sqrt(k))/(45*sqrt(7.)*(-1 + k**2)**9*t**4)

endif

!*********************
case(8)  ! <d1|d2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((79380*t + 79380*t**2 + 29295*t**3 + 2835*t**4 - 1485*t**5 - 666*t**6 - 114*t**7 + 3*t**8 &
                  + 5*t**9)*exp(-t))/(17010*t*sqrt(35.))
ovlp(1) = ovlp(1) - ((-26460*t - 26460*t**2 - 10395*t**3 - 1575*t**4 + 240*t**5 + 177*t**6 + 43*t**7 &
                  + 5*t**8)*exp(-t))/(5670*t*sqrt(35.))
ovlp(2) = ovlp(2) + ((26460*t + 26460*t**2 + 12285*t**3 + 3465*t**4 + 645*t**5 + 78*t**6 + 5*t**7)*exp(-t))/(5670*t*sqrt(35.))

else

ovlp(0) = ovlp(0) + (128*k**5*((-2177280*k - 9434880*k**3 - 725760*k*(3 + 13*k**2)*t + 5760*k*(-177 - 752*k**2 + 33*k**4)*t**2 &
                  + 5760*k*(-51 - 206*k**2 + 33*k**4)*t**3 - 480*k*(123 + 463*k**2 - 147*k**4 + 9*k**6)*t**4 + 24*k*(-1 &
                  + k**2)*(333 + 1261*k**2 + 79*k**4 + 7*k**6)*t**5 - 24*k*(-1 + k**2)**2*(27 + 86*k**2 + 7*k**4)*t**6 + 8*k*(-1 &
                  + k**2)**3*(3 + 7*k**2)*t**7)*exp(-t) + (2177280*k + 9434880*k**3 + 725760*k**2*(3 + 13*k**2)*t + 11520*k*(-6 &
                  + 61*k**2 + 393*k**4)*t**2 + 23040*k**2*(-3 - k**2 + 60*k**4)*t**3 + 960*k*(3 - 13*k**2 - 81*k**4 &
                  + 315*k**6)*t**4 + 24*(-1 + k**2)*(7 + 139*k**2 + 581*k**4 + 2073*k**6)*t**5 + 24*k*(-1 + k**2)**2*(17 &
                  + 126*k**2 + 257*k**4)*t**6 + (-1 + k**2)**3*(11 + 234*k**2 + 555*k**4)*t**7 + k*(-1 + k**2)**4*(7 &
                  + 33*k**2)*t**8 + k**2*(-1 + k**2)**5*t**9)*exp(-(k*t)))*sqrt(k))/(9*sqrt(35.)*(-1 + k**2)**9*t**5)
 
ovlp(1) = ovlp(1) + (-128*k**5*((-483840*k - 2096640*k**3 - 161280*k*(3 + 13*k**2)*t + 1920*k*(-114 - 479*k**2 + 33*k**4)*t**2 &
                  + 1920*k*(-30 - 115*k**2 + 33*k**4)*t**3 + 2880*k*(-1 + k**2)*(3 + 11*k**2)*t**4 - 8*k*(-1 + k**2)**2*(87 &
                  + 266*k**2 + 7*k**4)*t**5 + 8*k*(-1 + k**2)**3*(3 + 7*k**2)*t**6)*exp(-t) + (483840*k + 2096640*k**3 &
                  + 161280*k**2*(3 + 13*k**2)*t + 1920*k*(-12 + 59*k**2 + 513*k**4)*t**2 + 1920*k**2*(-12 - 25*k**2 &
                  + 149*k**4)*t**3 + 1920*k**3*(-1 + k**2)*(6 + 29*k**2)*t**4 + 8*(-1 + k**2)**2*(7 + 266*k**2 + 927*k**4)*t**5 &
                  + 8*k*(-1 + k**2)**3*(17 + 83*k**2)*t**6 + (-1 + k**2)**4*(3 + 37*k**2)*t**7 + k*(-1 &
                  + k**2)**5*t**8)*exp(-(k*t)))*sqrt(k))/(3*sqrt(35.)*(-1 + k**2)**9*t**5)

ovlp(2) = ovlp(2) + (128*k**5*((-120960*k - 524160*k**3 - 40320*k*(3 + 13*k**2)*t + 960*k*(-51 - 206*k**2 + 33*k**4)*t**2 &
                  + 2880*k*(-1 + k**2)*(3 + 11*k**2)*t**3 - 720*k*(-1 + k**2)**2*(1 + 3*k**2)*t**4 + 8*k*(-1 + k**2)**3*(3 &
                  + 7*k**2)*t**5)*exp(-t) + (120960*k + 524160*k**3 + 40320*k**2*(3 + 13*k**2)*t + 3840*k*(-3 - k**2 &
                  + 60*k**4)*t**2 + 1920*k**2*(-1 + k**2)*(6 + 29*k**2)*t**3 + 480*k*(-1 + k**2)**2*(3 + 17*k**2)*t**4 &
                  + 8*(-1 + k**2)**3*(7 + 93*k**2)*t**5 + 40*k*(-1 + k**2)**4*t**6 + (-1 &
                  + k**2)**5*t**7)*exp(-(k*t)))*sqrt(k))/(3*sqrt(35.)*(-1 + k**2)**9*t**5)

endif

end select

! ------------------------------ n1 = n2 = 4 -----------------------------------
  case(13) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)  ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((99225 + 99225*t + 47250*t**2 + 14175*t**3 + 3024*t**4 + 504*t**5 + 72*t**6 + 9*t**7 &
                  + t**8)*exp(-t))/99225 
else
ovlp(0) = ovlp(0) + (32*k**4*((3024 + 91584*k**2 + 240864*k**4 + 91584*k**6 + 3024*k**8 - 192*(-1 + k**2)*(7 &
                  + 169*k**2 + 321*k**4 + 63*k**6)*t + 12*(-1 + k**2)**2*(21 + 393*k**2 + 511*k**4 &
                  + 35*k**6)*t**2 - 8*(-1 + k**2)**3*(3 + 42*k**2 + 35*k**4)*t**3 + (-1 + k**2)**4*(1 + 10*k**2 &
                  + 5*k**4)*t**4)*exp(-t) + (-3024 - 91584*k**2 - 240864*k**4 - 91584*k**6 - 3024*k**8 - 192*k*(-1 &
                  + k**2)*(63 + 321*k**2 + 169*k**4 + 7*k**6)*t - 12*(-1 + k**2)**2*(35 + 511*k**2 + 393*k**4 &
                  + 21*k**6)*t**2 - 8*k*(-1 + k**2)**3*(35 + 42*k**2 + 3*k**4)*t**3 - (-1 + k**2)**4*(5 + 10*k**2 &
                  + k**4)*t**4)*exp(-(k*t)))*sqrt(k))/(105*(-1 + k**2)**9*t) 
endif

!*****************************************
case(1,3)  ! l1 = 1 and l2 = 0  => <p1|s2> 
!*****************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(33075 + 33075*t + 16065*t**2 + 5040*t**3 + 1152*t**4 + 207*t**5 + 31*t**6 &
                  + 4*t**7)*exp(-t))/(132300*sqrt(3.))
else
ovlp(0) = ovlp(0) + (-32*k**4*((-47520*k - 258720*k**3 - 119520*k**5 - 4320*k**7 - 480*k*(99 + 539*k**2 &
                  + 249*k**4 + 9*k**6)*t + 96*k*(-1 + k**2)*(153 + 701*k**2 + 259*k**4 + 7*k**6)*t**2 - 32*k*(-1 &
                  + k**2)**2*(69 + 242*k**2 + 49*k**4)*t**3 + 2*k*(-1 + k**2)**3*(87 + 218*k**2 + 15*k**4)*t**4 &
                  - 2*k*(-1 + k**2)**4*(3 + 5*k**2)*t**5)*exp(-t) + (47520*k + 258720*k**3 + 119520*k**5 + 4320*k**7 &
                  + 480*k**2*(99 + 539*k**2 + 249*k**4 + 9*k**6)*t + 48*k*(-1 + k**2)*(189 + 1293*k**2 + 727*k**4 &
                  + 31*k**6)*t**2 + 2*(-1 + k**2)**2*(175 + 3059*k**2 + 2397*k**4 + 129*k**6)*t**3 + 8*k*(-1 &
                  + k**2)**3*(35 + 42*k**2 + 3*k**4)*t**4 + (-1 + k**2)**4*(5 + 10*k**2 &
                  + k**4)*t**5)*exp(-(k*t)))*sqrt(k))/(35*sqrt(3.)*(-1 + k**2)**9*t**2)
endif

!***************************************
case(2,6)  ! l1 = 2 and l2 = 0  => <d1|s2> 
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) +  (t**2*(-945 - 945*t - 216*t**2 + 99*t**3 + 75*t**4 + 21*t**5 + 4*t**6)*exp(-t))/(79380*sqrt(5.))
else
ovlp(0) = ovlp(0) + (-32*k**4*((-47520 - 807840*k**2 - 419040*k**4 - 15840*k**6 - 1440*(33 + 561*k**2 + 291*k**4 &
                  + 11*k**6)*t + 96*(-216 - 3501*k**2 - 1021*k**4 + 249*k**6 + 9*k**8)*t**2 + 96*(-1 + k**2)*(51 &
                  + 747*k**2 + 313*k**4 + 9*k**6)*t**3 - 6*(-1 + k**2)**2*(113 + 1381*k**2 + 419*k**4 + 7*k**6)*t**4 &
                  + 2*(-1 + k**2)**3*(27 + 258*k**2 + 35*k**4)*t**5 - 2*(-1 + k**2)**4*(1 + 7*k**2)*t**6)*exp(-t) &
                  + (47520 + 807840*k**2 + 419040*k**4 + 15840*k**6 + 1440*k*(33 + 561*k**2 + 291*k**4 + 11*k**6)*t &
                  + 48*(-63 - 918*k**2 + 6092*k**4 + 3702*k**6 + 147*k**8)*t**2 + 48*k*(-1 + k**2)*(63 + 1311*k**2 &
                  + 829*k**4 + 37*k**6)*t**3 + 30*(-1 + k**2)**2*(7 + 203*k**2 + 165*k**4 + 9*k**6)*t**4 + 8*k*(-1 &
                  + k**2)**3*(35 + 42*k**2 + 3*k**4)*t**5 + (-1 + k**2)**4*(5 + 10*k**2 &
                  + k**4)*t**6)*exp(-(k*t)))*sqrt(k))/(21*sqrt(5.)*(-1 + k**2)**9*t**3)
endif

!***************************************
case(4)  ! l1 = l2 = 1  => <p1|p2> 
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((66150*t + 66150*t**2 + 27405*t**3 + 5355*t**4 + 90*t**5 - 225*t**6 - 67*t**7 - 13*t**8 &
                  - 2*t**9)*exp(-t))/(66150*t)
ovlp(1) = ovlp(1) -((-66150*t - 66150*t**2 - 31185*t**3 - 9135*t**4 - 1845*t**5 - 270*t**6 - 29*t**7 &
                  - 2*t**8)*exp(-t))/(66150*t) 
else
ovlp(0) = ovlp(0) + (-64*k**4*((63360*k + 303360*k**3 + 63360*k**5 + 1920*k*(33 + 158*k**2 + 33*k**4)*t + 960*k*(33 &
                  + 158*k**2 + 33*k**4)*t**2 - 40*k*(-1 + k**2)*(201 + 877*k**2 + 259*k**4 + 7*k**6)*t**3 + 8*k*(-1 &
                  + k**2)**2*(141 + 488*k**2 + 91*k**4)*t**4 - k*(-1 + k**2)**3*(87 + 218*k**2 + 15*k**4)*t**5 &
                  + k*(-1 + k**2)**4*(3 + 5*k**2)*t**6)*exp(-t) + (-63360*k - 303360*k**3 - 63360*k**5 &
                  - 1920*k**2*(33 + 158*k**2 + 33*k**4)*t - 960*k**3*(33 + 158*k**2 + 33*k**4)*t**2 - 40*(-1 &
                  + k**2)*(7 + 259*k**2 + 877*k**4 + 201*k**6)*t**3 - 8*k*(-1 + k**2)**2*(91 + 488*k**2 &
                  + 141*k**4)*t**4 - (-1 + k**2)**3*(15 + 218*k**2 + 87*k**4)*t**5 - k*(-1 + k**2)**4*(5 &
                  + 3*k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(35*(-1 + k**2)**9*t**3)

ovlp(1) = ovlp(1) + (64*k**4*((31680*k + 151680*k**3 + 31680*k**5 + 960*k*(33 + 158*k**2 + 33*k**4)*t - 240*k*(-1 &
                  + k**2)*(39 + 158*k**2 + 27*k**4)*t**2 + 40*k*(-1 + k**2)**2*(33 + 104*k**2 + 7*k**4)*t**3 &
                  - 32*k*(-1 + k**2)**3*(3 + 7*k**2)*t**4 + k*(-1 + k**2)**4*(3 + 5*k**2)*t**5)*exp(-t) + (-31680*k &
                  - 151680*k**3 - 31680*k**5 - 960*k**2*(33 + 158*k**2 + 33*k**4)*t - 240*k*(-1 + k**2)*(27 &
                  + 158*k**2 + 39*k**4)*t**2 - 40*(-1 + k**2)**2*(7 + 104*k**2 + 33*k**4)*t**3 - 32*k*(-1 &
                  + k**2)**3*(7 + 3*k**2)*t**4 - (-1 + k**2)**4*(5 + 3*k**2)*t**5)*exp(-(k*t)))*sqrt(k))/(35*(-1 &
                  + k**2)**9*t**3)

endif

!***************************************
case(5,7)  ! l1 = 2 and l2 = 1  => <d1|p2> 
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((13230*t**2 + 13230*t**3 + 5805*t**4 + 1395*t**5 + 162*t**6 - 9*t**7 - 8*t**8 &
                  - 2*t**9)*exp(-t))/(13230*t*sqrt(15.))
ovlp(1) = ovlp(1) +  ((6615*t**2 + 6615*t**3 + 3105*t**4 + 900*t**5 + 177*t**6 + 24*t**7 &
                  + 2*t**8)*exp(-t))/(13230*t*sqrt(5.))
else
ovlp(0) = ovlp(0) + (64*k**4*((-95040 - 1503360*k**2 - 336960*k**4 - 8640*(11 + 174*k**2 + 39*k**4)*t + 240*(-189 &
                  - 2949*k**2 - 479*k**4 + 33*k**6)*t**2 + 240*(-57 - 861*k**2 - 11*k**4 + 33*k**6)*t**3 + 24*(-1 &
                  + k**2)*(113 + 1601*k**2 + 499*k**4 + 27*k**6)*t**4 - 4*(-1 + k**2)**2*(87 + 1053*k**2 + 293*k**4 &
                  + 7*k**6)*t**5 + (-1 + k**2)**3*(27 + 258*k**2 + 35*k**4)*t**6 - (-1 + k**2)**4*(1 &
                  + 7*k**2)*t**7)*exp(-t) + (95040 + 1503360*k**2 + 336960*k**4 + 8640*k*(11 + 174*k**2 + 39*k**4)*t &
                  + 240*(-9 + 15*k**2 + 2909*k**4 + 669*k**6)*t**2 + 240*k*(-9 - 117*k**2 + 821*k**4 + 201*k**6)*t**3 &
                  + 24*(-1 + k**2)*(7 + 259*k**2 + 1581*k**4 + 393*k**6)*t**4 + 8*k*(-1 + k**2)**2*(77 + 496*k**2 &
                  + 147*k**4)*t**5 + (-1 + k**2)**3*(15 + 218*k**2 + 87*k**4)*t**6 + k*(-1 + k**2)**4*(5 &
                  + 3*k**2)*t**7)*exp(-(k*t)))*sqrt(k))/(7*sqrt(15.)*(-1 + k**2)**9*t**4)

ovlp(1) = ovlp(1) + (64*k**4*((31680 + 501120*k**2 + 112320*k**4 + 2880*(11 + 174*k**2 + 39*k**4)*t - 240*(-57 &
                  - 861*k**2 - 11*k**4 + 33*k**6)*t**2 - 240*(-1 + k**2)*(13 + 178*k**2 + 33*k**4)*t**3 + 24*(-1 &
                  + k**2)**2*(17 + 196*k**2 + 27*k**4)*t**4 - 2*(-1 + k**2)**3*(15 + 138*k**2 + 7*k**4)*t**5 + (-1 &
                  + k**2)**4*(1 + 7*k**2)*t**6)*exp(-t) + (-31680 - 501120*k**2 - 112320*k**4 - 2880*k*(11 &
                  + 174*k**2 + 39*k**4)*t - 240*(-9 - 117*k**2 + 821*k**4 + 201*k**6)*t**2 - 240*k*(-1 + k**2)*(9 &
                  + 170*k**2 + 45*k**4)*t**3 - 24*(-1 + k**2)**2*(7 + 176*k**2 + 57*k**4)*t**4 - 32*k*(-1 &
                  + k**2)**3*(7 + 3*k**2)*t**5 - (-1 + k**2)**4*(5 &
                  + 3*k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(7*sqrt(5.)*(-1 + k**2)**9*t**4)
endif

!***************************************
case(8)  ! l1 = l2 = 2  => <d1|d2> 
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((39690*t + 39690*t**2 + 13905*t**3 + 675*t**4 - 972*t**5 - 315*t**6 - 33*t**7 &
                  + 3*t**8 + 2*t**9)*exp(-t))/(39690*t)
ovlp(1) = ovlp(1) - ((-13230*t - 13230*t**2 - 4995*t**3 - 585*t**4 + 195*t**5 + 96*t**6 + 19*t**7 &
                  + 2*t**8)*exp(-t))/(13230*t)
ovlp(2) = ovlp(2) + ((13230*t + 13230*t**2 + 6075*t**3 + 1665*t**4 + 294*t**5 + 33*t**6 &
                  + 2*t**7)*exp(-t))/(13230*t)
else
ovlp(0) = ovlp(0) + (-64*k**4*((-673920 - 10264320*k**2 - 673920*k**4 - 51840*(13 + 198*k**2 + 13*k**4)*t &
                  + 1440*(-223 - 3351*k**2 - 21*k**4 + 11*k**6)*t**2 + 1440*(-67 - 975*k**2 + 135*k**4 &
                  + 11*k**6)*t**3 - 48*(429 + 5964*k**2 - 2006*k**4 + 84*k**6 + 9*k**8)*t**4 + 120*(-1 &
                  + k**2)*(27 + 363*k**2 + 49*k**4 + 9*k**6)*t**5 - 6*(-1 + k**2)**2*(61 + 725*k**2 &
                  + 167*k**4 + 7*k**6)*t**6 + (-1 + k**2)**3*(27 + 258*k**2 + 35*k**4)*t**7 - (-1 + k**2)**4*(1 &
                  + 7*k**2)*t**8)*exp(-t) + (673920 + 10264320*k**2 + 673920*k**4 + 51840*k*(13 + 198*k**2 &
                  + 13*k**4)*t + 1440*(-11 + 21*k**2 + 3351*k**4 + 223*k**6)*t**2 + 1440*k*(-11 - 135*k**2 &
                  + 975*k**4 + 67*k**6)*t**3 + 48*(9 + 84*k**2 - 2006*k**4 + 5964*k**6 + 429*k**8)*t**4 + 120*k*(-1 &
                  + k**2)*(9 + 49*k**2 + 363*k**4 + 27*k**6)*t**5 + 6*(-1 + k**2)**2*(7 + 167*k**2 + 725*k**4 &
                  + 61*k**6)*t**6 + k*(-1 + k**2)**3*(35 + 258*k**2 + 27*k**4)*t**7 + k**2*(-1 + k**2)**4*(7 &
                  + k**2)*t**8)*exp(-(k*t)))*sqrt(k))/(21*(-1 + k**2)**9*t**5)

ovlp(1) = ovlp(1) + (64*k**4*((-149760 - 2280960*k**2 - 149760*k**4 - 11520*(13 + 198*k**2 + 13*k**4)*t + 480*(-145 &
                  - 2163*k**2 + 57*k**4 + 11*k**6)*t**2 + 480*(-41 - 579*k**2 + 161*k**4 + 11*k**6)*t**3 + 240*(-1 &
                  + k**2)*(15 + 198*k**2 + 11*k**4)*t**4 - 8*(-1 + k**2)**2*(53 + 604*k**2 + 63*k**4)*t**5 + 2*(-1 &
                  + k**2)**3*(15 + 138*k**2 + 7*k**4)*t**6 - (-1 + k**2)**4*(1 + 7*k**2)*t**7)*exp(-t) + (149760 &
                  + 2280960*k**2 + 149760*k**4 + 11520*k*(13 + 198*k**2 + 13*k**4)*t + 480*(-11 - 57*k**2 + 2163*k**4 &
                  + 145*k**6)*t**2 + 480*k*(-11 - 161*k**2 + 579*k**4 + 41*k**6)*t**3 + 240*k**2*(-1 + k**2)*(11 &
                  + 198*k**2 + 15*k**4)*t**4 + 8*k*(-1 + k**2)**2*(63 + 604*k**2 + 53*k**4)*t**5 + 2*(-1 + k**2)**3*(7 &
                  + 138*k**2 + 15*k**4)*t**6 + k*(-1 + k**2)**4*(7 + k**2)*t**7)*exp(-(k*t)))*sqrt(k))/(7*(-1 &
                  + k**2)**9*t**5)

ovlp(2) = ovlp(2) + (64*k**4*((37440 + 570240*k**2 + 37440*k**4 + 2880*(13 + 198*k**2 + 13*k**4)*t - 240*(-67 &
                  - 975*k**2 + 135*k**4 + 11*k**6)*t**2 - 240*(-1 + k**2)*(15 + 198*k**2 + 11*k**4)*t**3 + 24*(-1 &
                  + k**2)**2*(19 + 212*k**2 + 9*k**4)*t**4 - 32*(-1 + k**2)**3*(1 + 9*k**2)*t**5 + (-1 + k**2)**4*(1 &
                  + 7*k**2)*t**6)*exp(-t) + (-37440 - 570240*k**2 - 37440*k**4 - 2880*k*(13 + 198*k**2 + 13*k**4)*t &
                  - 240*(-11 - 135*k**2 + 975*k**4 + 67*k**6)*t**2 - 240*k*(-1 + k**2)*(11 + 198*k**2 + 15*k**4)*t**3 &
                  - 24*(-1 + k**2)**2*(9 + 212*k**2 + 19*k**4)*t**4 - 32*k*(-1 + k**2)**3*(9 + k**2)*t**5 - (-1 &
                  + k**2)**4*(7 + k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(7*(-1 + k**2)**9*t**5)

endif

end select  

! ------------------------------ n1 = 5 and n2 = 4 -----------------------------
  case(14) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((893025 + 893025*t + 429975*t**2 + 132300*t**3 + 29295*t**4 + 5040*t**5 + 720*t**6 + 90*t**7 &
                  + 10*t**8 + t**9)*exp(-t)*sqrt(2./5.))/595350.
else

ovlp(0) = ovlp(0) + (-32*k**5*((-237600*k - 2428800*k**3 - 3921600*k**5 - 1123200*k**7 - 30240*k**9 + 1920*k*(-1 + k**2)*(45 &
                  + 365*k**2 + 423*k**4 + 63*k**6)*t - 480*k*(-1 + k**2)**2*(27 + 169*k**2 + 133*k**4 + 7*k**6)*t**2 &
                  + 320*k*(-1 + k**2)**3*(3 + 14*k**2 + 7*k**4)*t**3 - 10*k*(-1 + k**2)**4*(3 + k**2)*(1 + 3*k**2)*t**4)*exp(-t) &
                  + (237600*k + 2428800*k**3 + 3921600*k**5 + 1123200*k**7 + 30240*k**9 + 240*(-1 + k**2)*(63 + 1908*k**2 &
                  + 5018*k**4 + 1908*k**6 + 63*k**8)*t + 480*k*(-1 + k**2)**2*(63 + 321*k**2 + 169*k**4 + 7*k**6)*t**2 + 20*(-1 &
                  + k**2)**3*(35 + 511*k**2 + 393*k**4 + 21*k**6)*t**3 + 10*k*(-1 + k**2)**4*(35 + 42*k**2 + 3*k**4)*t**4 + (-1 &
                  + k**2)**5*(5 + 10*k**2 + k**4)*t**5)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(315*(-1 + k**2)**10*t)
endif

!*******************
case(1)   ! <s1|p2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-66150*t**2 - 66150*t**3 - 34965*t**4 - 12915*t**5 - 3600*t**6 - 765*t**7 - 125*t**8 - 17*t**9 &
                  - 2*t**10)*exp(-t)*sqrt(2./15.))/(396900*t)
else
ovlp(0) = ovlp(0) + (64*k**5*((-158400*k - 1473600*k**3 - 1953600*k**5 - 285120*k**7 - 960*k*(165 + 1535*k**2 + 2035*k**4 &
                  + 297*k**6)*t + 240*k*(-1 + k**2)*(195 + 1535*k**2 + 1665*k**4 + 189*k**6)*t**2 - 40*k*(-1 + k**2)**2*(165 &
                  + 1025*k**2 + 791*k**4 + 35*k**6)*t**3 + 160*k*(-1 + k**2)**3*(3 + 14*k**2 + 7*k**4)*t**4 - 5*k*(-1 &
                  + k**2)**4*(3 + k**2)*(1 + 3*k**2)*t**5)*exp(-t) + (158400*k + 1473600*k**3 + 1953600*k**5 + 285120*k**7 &
                  + 960*k**2*(165 + 1535*k**2 + 2035*k**4 + 297*k**6)*t + 1200*k*(-1 + k**2)*(27 + 307*k**2 + 481*k**4 &
                  + 81*k**6)*t**2 + 160*(-1 + k**2)**2*(7 + 214*k**2 + 511*k**4 + 108*k**6)*t**3 + 200*k*(-1 + k**2)**3*(7 &
                  + 32*k**2 + 9*k**4)*t**4 + 4*(-1 + k**2)**4*(5 + 68*k**2 + 27*k**4)*t**5 + k*(-1 + k**2)**5*(5 &
                  + 3*k**2)*t**6)*exp(-(k*t)))*sqrt(2./15.)*sqrt(k))/(105*(-1 + k**2)**10*t**2)
endif

!*******************
case(2)   ! <s1|d2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-13230*t**3 - 13230*t**4 - 5535*t**5 - 1125*t**6 - 45*t**7 + 36*t**8 + 11*t**9 &
                  + 2*t**10)*exp(-t)*sqrt(2.))/(1190700*t)
else

ovlp(0) = ovlp(0) + (-64*k**5*((-561600*k - 4968000*k**3 - 5797440*k**5 - 285120*k**7 - 8640*k*(65 + 575*k**2 + 671*k**4 &
                  + 33*k**6)*t + 240*k*(-1005 - 8360*k**2 - 7978*k**4 + 1152*k**6 + 63*k**8)*t**2 + 240*k*(-1 + k**2)*(225 &
                  + 1685*k**2 + 1611*k**4 + 63*k**6)*t**3 - 120*k*(-1 + k**2)**2*(57 + 349*k**2 + 259*k**4 + 7*k**6)*t**4 &
                  + 160*k*(-1 + k**2)**3*(3 + 14*k**2 + 7*k**4)*t**5 - 5*k*(-1 + k**2)**4*(3 + k**2)*(1 + 3*k**2)*t**6)*exp(-t) &
                  + (561600*k + 4968000*k**3 + 5797440*k**5 + 285120*k**7 + 8640*k**2*(65 + 575*k**2 + 671*k**4 + 33*k**6)*t &
                  + 240*k*(-165 - 820*k**2 + 6250*k**4 + 10332*k**6 + 531*k**8)*t**2 + 1200*k**2*(-1 + k**2)*(33 + 353*k**2 &
                  + 483*k**4 + 27*k**6)*t**3 + 120*k*(-1 + k**2)**2*(27 + 389*k**2 + 661*k**4 + 43*k**6)*t**4 + 8*(-1 &
                  + k**2)**3*(7 + 302*k**2 + 825*k**4 + 66*k**6)*t**5 + k*(-1 + k**2)**4*(49 + 318*k**2 + 33*k**4)*t**6 &
                  + k**2*(-1 + k**2)**5*(7 + k**2)*t**7)*exp(-(k*t)))*sqrt(2.)*sqrt(k))/(315*(-1 + k**2)**10*t**3)
endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t*(99225 + 99225*t + 47250*t**2 + 14175*t**3 + 3024*t**4 + 504*t**5 + 72*t**6 + 9*t**7 &
                  + t**8)*exp(-t)*sqrt(2./15.))/198450
else

ovlp(0) = ovlp(0) + (-32*k**5*((-47520 - 1584000*k**2 - 4478400*k**4 - 1584000*k**6 - 47520*k**8 - 1440*(33 + 1100*k**2 &
                  + 3110*k**4 + 1100*k**6 + 33*k**8)*t + 96*(-1 + k**2)*(153 + 4398*k**2 + 10408*k**4 + 2898*k**6 &
                  + 63*k**8)*t**2 - 96*(-1 + k**2)**2*(23 + 541*k**2 + 969*k**4 + 147*k**6)*t**3 + 6*(-1 + k**2)**3*(29 &
                  + 537*k**2 + 679*k**4 + 35*k**6)*t**4 - 2*(-1 + k**2)**4*(3 + 42*k**2 + 35*k**4)*t**5)*exp(-t) + (47520 &
                  + 1584000*k**2 + 4478400*k**4 + 1584000*k**6 + 47520*k**8 + 1440*k*(33 + 1100*k**2 + 3110*k**4 + 1100*k**6 &
                  + 33*k**8)*t + 48*(-1 + k**2)*(189 + 7704*k**2 + 25834*k**4 + 10704*k**6 + 369*k**8)*t**2 + 96*k*(-1 &
                  + k**2)**2*(273 + 1611*k**2 + 879*k**4 + 37*k**6)*t**3 + 6*(-1 + k**2)**3*(105 + 1701*k**2 + 1323*k**4 &
                  + 71*k**6)*t**4 + 10*k*(-1 + k**2)**4*(35 + 42*k**2 + 3*k**4)*t**5 + (-1 + k**2)**5*(5 + 10*k**2 &
                  + k**4)*t**6)*exp(-(k*t)))*sqrt(2./15.)*sqrt(k))/(105*(-1 + k**2)**10*t**2)
endif

!*********************************
case(4)   ! l1 = l2 = 1 => <p1|p2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((595350*t + 595350*t**2 + 257985*t**3 + 59535*t**4 + 5805*t**5 - 810*t**6 - 426*t**7 - 93*t**8 &
                  - 15*t**9 - 2*t**10)*exp(-t)*sqrt(2./5.))/(396900*t)
ovlp(1) = ovlp(1) - ((-595350*t - 595350*t**2 - 284445*t**3 - 85995*t**4 - 18360*t**5 - 2925*t**6 - 357*t**7 - 33*t**8 &
                  - 2*t**9)*exp(-t)*sqrt(2./5.))/(396900*t) 
else

ovlp(0) = ovlp(0) + (64*k**5*((-63360 - 1987200*k**2 - 4867200*k**4 - 823680*k**6 - 5760*(11 + 345*k**2 + 845*k**4 &
                  + 143*k**6)*t - 2880*(11 + 345*k**2 + 845*k**4 + 143*k**6)*t**2 + 120*(-1 + k**2)*(67 + 1882*k**2 &
                  + 4232*k**4 + 966*k**6 + 21*k**8)*t**3 - 24*(-1 + k**2)**2*(47 + 1099*k**2 + 1941*k**4 + 273*k**6)*t**4 &
                  + 3*(-1 + k**2)**3*(29 + 537*k**2 + 679*k**4 + 35*k**6)*t**5 - (-1 + k**2)**4*(3 + 42*k**2 &
                  + 35*k**4)*t**6)*exp(-t) + (63360 + 1987200*k**2 + 4867200*k**4 + 823680*k**6 + 5760*k*(11 + 345*k**2 &
                  + 845*k**4 + 143*k**6)*t + 2880*k**2*(11 + 345*k**2 + 845*k**4 + 143*k**6)*t**2 + 240*k*(-1 + k**2)*(105 &
                  + 1321*k**2 + 2587*k**4 + 467*k**6)*t**3 + 48*(-1 + k**2)**2*(21 + 657*k**2 + 1743*k**4 + 379*k**6)*t**4 &
                  + 96*k*(-1 + k**2)**3*(14 + 67*k**2 + 19*k**4)*t**5 + 4*(-1 + k**2)**4*(5 + 68*k**2 + 27*k**4)*t**6 + k*(-1 &
                  + k**2)**5*(5 + 3*k**2)*t**7)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(105*(-1 + k**2)**10*t**3)

ovlp(1) = ovlp(1) + (-64*k**5*((-31680 - 993600*k**2 - 2433600*k**4 - 411840*k**6 - 2880*(11 + 345*k**2 + 845*k**4 + 143*k**6)*t &
                  + 240*(-1 + k**2)*(39 + 1059*k**2 + 2189*k**4 + 297*k**6)*t**2 - 120*(-1 + k**2)**2*(11 + 247*k**2 + 393*k**4 &
                  + 21*k**6)*t**3 + 96*(-1 + k**2)**3*(1 + 18*k**2 + 21*k**4)*t**4 - (-1 + k**2)**4*(3 + 42*k**2 &
                  + 35*k**4)*t**5)*exp(-t) + (31680 + 993600*k**2 + 2433600*k**4 + 411840*k**6 + 2880*k*(11 + 345*k**2 &
                  + 845*k**4 + 143*k**6)*t + 240*(-1 + k**2)*(27 + 1011*k**2 + 2881*k**4 + 561*k**6)*t**2 + 480*k*(-1 &
                  + k**2)**2*(39 + 194*k**2 + 47*k**4)*t**3 + 24*(-1 + k**2)**3*(21 + 288*k**2 + 91*k**4)*t**4 + 40*k*(-1 &
                  + k**2)**4*(7 + 3*k**2)*t**5 + (-1 + k**2)**5*(5 + 3*k**2)*t**6)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(105*(-1 &
                  + k**2)**10*t**3)
endif

!***************************************
case(5)   ! l1 = 1 and l2 = 2 => <p1|d2>
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((-79380*t**2 - 79380*t**3 - 37530*t**4 - 11070*t**5 - 2151*t**6 - 225*t**7 + 12*t**8 + 9*t**9 &
                  + 2*t**10)*exp(-t)*sqrt(2./3.))/(396900*t)
ovlp(1) = ovlp(1) - ((39690*t**2 + 39690*t**3 + 19305*t**4 + 6075*t**5 + 1371*t**6 + 228*t**7 + 27*t**8 &
                  + 2*t**9)*exp(-t)*sqrt(2.))/(396900*t)
else

ovlp(0) = ovlp(0) + (-64*k**5*((-336960 - 10238400*k**2 - 23025600*k**4 - 1235520*k**6 - 8640*(39 + 1185*k**2 + 2665*k**4 &
                  + 143*k**6)*t + 720*(-223 - 6700*k**2 - 14570*k**4 - 44*k**6 + 33*k**8)*t**2 + 720*(-67 - 1960*k**2 &
                  - 3910*k**4 + 528*k**6 + 33*k**8)*t**3 + 24*(-1 + k**2)*(393 + 10638*k**2 + 21848*k**4 + 2898*k**6 &
                  + 63*k**8)*t**4 - 24*(-1 + k**2)**2*(49 + 1133*k**2 + 1947*k**4 + 231*k**6)*t**5 + 3*(-1 + k**2)**3*(29 &
                  + 537*k**2 + 679*k**4 + 35*k**6)*t**6 - (-1 + k**2)**4*(3 + 42*k**2 + 35*k**4)*t**7)*exp(-t) + (336960 &
                  + 10238400*k**2 + 23025600*k**4 + 1235520*k**6 + 8640*k*(39 + 1185*k**2 + 2665*k**4 + 143*k**6)*t + 720*(-11 &
                  - 176*k**2 + 5690*k**4 + 15176*k**6 + 825*k**8)*t**2 + 720*k*(-11 - 332*k**2 + 950*k**4 + 4516*k**6 &
                  + 253*k**8)*t**3 + 24*(-1 + k**2)*(27 + 1572*k**2 + 14602*k**4 + 27012*k**6 + 1587*k**8)*t**4 + 24*k*(-1 &
                  + k**2)**2*(141 + 1787*k**2 + 3443*k**4 + 229*k**6)*t**5 + 3*(-1 + k**2)**3*(21 + 777*k**2 + 2223*k**4 &
                  + 179*k**6)*t**6 + k*(-1 + k**2)**4*(49 + 318*k**2 + 33*k**4)*t**7 + k**2*(-1 + k**2)**5*(7 &
                  + k**2)*t**8)*exp(-(k*t)))*sqrt(2./3.)*sqrt(k))/(105.*(-1 + k**2)**10*t**4)

ovlp(1) = ovlp(1) + (64*k**5*((-112320 - 3412800*k**2 - 7675200*k**4 - 411840*k**6 - 2880*(39 + 1185*k**2 + 2665*k**4 &
                  + 143*k**6)*t + 720*(-67 - 1960*k**2 - 3910*k**4 + 528*k**6 + 33*k**8)*t**2 + 240*(-1 + k**2)*(45 &
                  + 1185*k**2 + 2255*k**4 + 99*k**6)*t**3 - 72*(-1 + k**2)**2*(19 + 423*k**2 + 657*k**4 + 21*k**6)*t**4 &
                  + 96*(-1 + k**2)**3*(1 + 18*k**2 + 21*k**4)*t**5 - (-1 + k**2)**4*(3 + 42*k**2 + 35*k**4)*t**6)*exp(-t) &
                  + (112320 + 3412800*k**2 + 7675200*k**4 + 411840*k**6 + 2880*k*(39 + 1185*k**2 + 2665*k**4 + 143*k**6)*t &
                  + 720*(-11 - 332*k**2 + 950*k**4 + 4516*k**6 + 253*k**8)*t**2 + 240*k*(-1 + k**2)*(33 + 1185*k**2 &
                  + 3075*k**4 + 187*k**6)*t**3 + 24*(-1 + k**2)**2*(27 + 1269*k**2 + 4021*k**4 + 283*k**6)*t**4 + 24*k*(-1 &
                  + k**2)**3*(57 + 316*k**2 + 27*k**4)*t**5 + (-1 + k**2)**4*(21 + 342*k**2 + 37*k**4)*t**6 + k*(-1 &
                  + k**2)**5*(7 + k**2)*t**7)*exp(-(k*t)))*sqrt(2.)*sqrt(k))/(105.*(-1 + k**2)**10*t**4)

endif

!********************
case(6)   ! <d1|s2>
!********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(6615 + 6615*t + 3510*t**2 + 1305*t**3 + 369*t**4 + 81*t**5 + 14*t**6 &
                  + 2*t**7)*exp(-t)*sqrt(2.))/1190700
else

ovlp(0) = ovlp(0) + (-32*k**5*((-2471040*k - 14601600*k**3 - 5961600*k**5 - 190080*k**7 - 17280*k*(143 + 845*k**2 + 345*k**4 &
                  + 11*k**6)*t + 960*k*(-1089 - 6010*k**2 - 1280*k**4 + 306*k**6 + 9*k**8)*t**2 + 960*k*(-1 + k**2)*(231 &
                  + 1171*k**2 + 381*k**4 + 9*k**6)*t**3 - 48*k*(-1 + k**2)**2*(543 + 2281*k**2 + 529*k**4 + 7*k**6)*t**4 &
                  + 80*k*(-1 + k**2)**3*(21 + 68*k**2 + 7*k**4)*t**5 - 16*k*(-1 + k**2)**4*(3 + 7*k**2)*t**6)*exp(-t) &
                  + (2471040*k + 14601600*k**3 + 5961600*k**5 + 190080*k**7 + 17280*k**2*(143 + 845*k**2 + 345*k**4 + 11*k**6)*t &
                  + 1920*k*(-99 - 154*k**2 + 2890*k**4 + 1350*k**6 + 45*k**8)*t**2 + 1920*k**2*(-1 + k**2)*(99 + 682*k**2 &
                  + 327*k**4 + 12*k**6)*t**3 + 96*k*(-1 + k**2)**2*(189 + 1623*k**2 + 947*k**4 + 41*k**6)*t**4 + 2*(-1 &
                  + k**2)**3*(245 + 5089*k**2 + 4047*k**4 + 219*k**6)*t**5 + 10*k*(-1 + k**2)**4*(35 + 42*k**2 + 3*k**4)*t**6 &
                  + (-1 + k**2)**5*(5 + 10*k**2 + k**4)*t**7)*exp(-(k*t)))*sqrt(2.)*sqrt(k))/(315.*(-1 + k**2)**10*t**3)

endif

!*********************
case(7)  ! <d1|p2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((132300*t**2 + 132300*t**3 + 58590*t**4 + 14490*t**5 + 1935*t**6 + 45*t**7 - 38*t**8 - 11*t**9 &
                  - 2*t**10)*exp(-t)*sqrt(2./3.))/(396900*t)
ovlp(1) = ovlp(1) + ((66150*t**2 + 66150*t**3 + 31185*t**4 + 9135*t**5 + 1845*t**6 + 270*t**7 + 29*t**8 &
                  + 2*t**9)*exp(-t)*sqrt(2.))/(396900*t)
else

ovlp(0) = ovlp(0) + (64*k**5*((-4717440*k - 25401600*k**3 - 4717440*k**5 - 362880*k*(13 + 70*k**2 + 13*k**4)*t + 960*k*(-2325 &
               - 12275*k**2 - 1627*k**4 + 99*k**6)*t**2 + 960*k*(-687 - 3455*k**2 + 11*k**4 + 99*k**6)*t**3 + 240*k*(-1 &
               + k**2)*(501 + 2441*k**2 + 615*k**4 + 27*k**6)*t**4 - 16*k*(-1 + k**2)**2*(831 + 3452*k**2 + 743*k**4 & 
               + 14*k**6)*t**5 + 40*k*(-1 + k**2)**3*(21 + 68*k**2 + 7*k**4)*t**6 - 8*k*(-1 + k**2)**4*(3 &
               + 7*k**2)*t**7)*exp(-t) + (4717440*k + 25401600*k**3 + 4717440*k**5 + 362880*k**2*(13 + 70*k**2 + 13*k**4)*t &
               + 1920*k*(-66 + 751*k**2 + 6200*k**4 + 1179*k**6)*t**2 + 3840*k**2*(-33 - 34*k**2 + 895*k**4 + 180*k**6)*t**3 &
               + 480*k*(-1 + k**2)*(27 + 439*k**2 + 1477*k**4 + 297*k**6)*t**4 + 16*(-1 + k**2)**2*(49 + 1633*k**2 + 5467*k**4 &
               + 1251*k**6)*t**5 + 16*k*(-1 + k**2)**3*(77 + 406*k**2 + 117*k**4)*t**6 + 4*(-1 + k**2)**4*(5 + 68*k**2 &
               + 27*k**4)*t**7 + k*(-1 + k**2)**5*(5 + 3*k**2)*t**8)*exp(-(k*t)))*sqrt(2./3.)*sqrt(k))/(105*(-1 + k**2)**10*t**4)
 
ovlp(1) = ovlp(1) + (-64*k**5*((-1572480*k - 8467200*k**3 - 1572480*k**5 - 120960*k*(13 + 70*k**2 + 13*k**4)*t + 960*k*(-687 &
                  - 3455*k**2 + 11*k**4 + 99*k**6)*t**2 + 960*k*(-1 + k**2)*(141 + 656*k**2 + 99*k**4)*t**3 - 720*k*(-1 &
                  + k**2)**2*(21 + 82*k**2 + 9*k**4)*t**4 + 16*k*(-1 + k**2)**3*(57 + 176*k**2 + 7*k**4)*t**5 - 8*k*(-1 &
                  + k**2)**4*(3 + 7*k**2)*t**6)*exp(-t) + (1572480*k + 8467200*k**3 + 1572480*k**5 + 120960*k**2*(13 &
                  + 70*k**2 + 13*k**4)*t + 3840*k*(-33 - 34*k**2 + 895*k**4 + 180*k**6)*t**2 + 1920*k**2*(-1 + k**2)*(66 &
                  + 407*k**2 + 87*k**4)*t**3 + 480*k*(-1 + k**2)**2*(27 + 202*k**2 + 51*k**4)*t**4 + 8*(-1 + k**2)**3*(49 &
                  + 872*k**2 + 279*k**4)*t**5 + 40*k*(-1 + k**2)**4*(7 + 3*k**2)*t**6 + (-1 + k**2)**5*(5 &
                  + 3*k**2)*t**7)*exp(-(k*t)))*sqrt(2.)*sqrt(k))/(105*(-1 + k**2)**10*t**4)

endif

!*********************
case(8)  ! <d1|d2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((357210*t + 357210*t**2 + 137025*t**3 + 17955*t**4 - 4185*t**5 - 2232*t**6 - 414*t**7 - 27*t**8 &
                  + 5*t**9 + 2*t**10)*exp(-t)*sqrt(2./5.))/(238140*t)
ovlp(1) = ovlp(1) - ((-119070*t - 119070*t**2 - 48195*t**3 - 8505*t**4 + 390*t**5 + 579*t**6 + 153*t**7 + 23*t**8 &
                  + 2*t**9)*exp(-t)*sqrt(2./5.))/(79380*t) 
ovlp(2) = ovlp(2) + ((119070*t + 119070*t**2 + 55755*t**3 + 16065*t**4 + 3135*t**5 + 426*t**6 + 39*t**7 &
                  + 2*t**8)*exp(-t)*sqrt(2./5.))/(79380*t)

else

ovlp(0) = ovlp(0) + (-64*k**5*((-32659200*k - 166924800*k**3 - 9434880*k**5 - 725760*k*(45 + 230*k**2 + 13*k**4)*t &
                  + 17280*k*(-893 - 4475*k**2 - 19*k**4 + 11*k**6)*t**2 + 17280*k*(-263 - 1255*k**2 + 163*k**4 + 11*k**6)*t**3 &
                  - 480*k*(1965 + 8740*k**2 - 2758*k**4 + 108*k**6 + 9*k**8)*t**4 + 240*k*(-1 + k**2)*(579 + 2639*k**2 &
                  + 321*k**4 + 45*k**6)*t**5 - 48*k*(-1 + k**2)**2*(288 + 1171*k**2 + 214*k**4 + 7*k**6)*t**6 + 40*k*(-1 &
                  + k**2)**3*(21 + 68*k**2 + 7*k**4)*t**7 - 8*k*(-1 + k**2)**4*(3 + 7*k**2)*t**8)*exp(-t) + (32659200*k &
                  + 166924800*k**3 + 9434880*k**5 + 725760*k**2*(45 + 230*k**2 + 13*k**4)*t + 34560*k*(-26 + 295*k**2 &
                  + 2288*k**4 + 131*k**6)*t**2 + 69120*k**2*(-13 - 10*k**2 + 339*k**4 + 20*k**6)*t**3 + 960*k*(33 - 148*k**2 &
                  - 1280*k**4 + 5112*k**6 + 315*k**8)*t**4 + 24*(-1 + k**2)*(63 + 1578*k**2 + 8248*k**4 + 32838*k**6 &
                  + 2073*k**8)*t**5 + 24*k*(-1 + k**2)**2*(153 + 1471*k**2 + 3719*k**4 + 257*k**6)*t**6 + (-1 + k**2)**3*(77 &
                  + 2161*k**2 + 6807*k**4 + 555*k**6)*t**7 + k*(-1 + k**2)**4*(49 + 318*k**2 + 33*k**4)*t**8 + k**2*(-1 &
                  + k**2)**5*(7 + k**2)*t**9)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(63*(-1 + k**2)**10*t**5) 
 
ovlp(1) = ovlp(1) + (64*k**5*((-7257600*k - 37094400*k**3 - 2096640*k**5 - 161280*k*(45 + 230*k**2 + 13*k**4)*t + 5760*k*(-578 &
                  - 2865*k**2 + 72*k**4 + 11*k**6)*t**2 + 1920*k*(-474 - 2155*k**2 + 580*k**4 + 33*k**6)*t**3 + 960*k*(-1 &
                  + k**2)*(159 + 704*k**2 + 33*k**4)*t**4 - 240*k*(-1 + k**2)**2*(65 + 250*k**2 + 21*k**4)*t**5 + 16*k*(-1 &
                  + k**2)**3*(57 + 176*k**2 + 7*k**4)*t**6 - 8*k*(-1 + k**2)**4*(3 + 7*k**2)*t**7)*exp(-t) + (7257600*k &
                  + 37094400*k**3 + 2096640*k**5 + 161280*k**2*(45 + 230*k**2 + 13*k**4)*t + 5760*k*(-52 + 275*k**2 + 2966*k**4 &
                  + 171*k**6)*t**2 + 1920*k**2*(-156 - 435*k**2 + 2458*k**4 + 149*k**6)*t**3 + 1920*k**3*(-1 + k**2)*(78 &
                  + 453*k**2 + 29*k**4)*t**4 + 24*(-1 + k**2)**2*(21 + 987*k**2 + 4283*k**4 + 309*k**6)*t**5 + 8*k*(-1 &
                  + k**2)**3*(153 + 964*k**2 + 83*k**4)*t**6 + (-1 + k**2)**4*(21 + 342*k**2 + 37*k**4)*t**7 + k*(-1 &
                  + k**2)**5*(7 + k**2)*t**8)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(21*(-1 + k**2)**10*t**5)

ovlp(2) = ovlp(2) + (-64*k**5*((-1814400*k - 9273600*k**3 - 524160*k**5 - 40320*k*(45 + 230*k**2 + 13*k**4)*t + 2880*k*(-263 &
                  - 1255*k**2 + 163*k**4 + 11*k**6)*t**2 + 960*k*(-1 + k**2)*(159 + 704*k**2 + 33*k**4)*t**3 - 720*k*(-1 &
                  + k**2)**2*(23 + 86*k**2 + 3*k**4)*t**4 + 960*k*(-1 + k**2)**3*(1 + 3*k**2)*t**5 - 8*k*(-1 + k**2)**4*(3 &
                  + 7*k**2)*t**6)*exp(-t) + (1814400*k + 9273600*k**3 + 524160*k**5 + 40320*k**2*(45 + 230*k**2 + 13*k**4)*t &
                  + 11520*k*(-13 - 10*k**2 + 339*k**4 + 20*k**6)*t**2 + 1920*k**2*(-1 + k**2)*(78 + 453*k**2 + 29*k**4)*t**3 &
                  + 480*k*(-1 + k**2)**2*(33 + 230*k**2 + 17*k**4)*t**4 + 24*(-1 + k**2)**3*(21 + 348*k**2 + 31*k**4)*t**5 &
                  + 40*k*(-1 + k**2)**4*(9 + k**2)*t**6 + (-1 + k**2)**5*(7 &
                  + k**2)*t**7)*exp(-(k*t)))*sqrt(2./5.)*sqrt(k))/(21*(-1 + k**2)**10*t**5)

endif

end select

! ------------------------------ n1 = 5 and n2 = 5 -----------------------------
  case(15) 
! ------------------------------------------------------------------------------

select case(llopt)

!*********************************
case(0)   ! l1 = l2 = 0 => <s1|s2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((9823275 + 9823275*t + 4729725*t**2 + 1455300*t**3 + 322245*t**4 + 55440*t**5 + 7920*t**6 + 990*t**7 &
                  + 110*t**8 + 11*t**9 + t**10)*exp(-t))/9823275.
else
ovlp(0) = ovlp(0) + (128*k**5*((-285120*k - 3590400*k**3 - 7731840*k**5 - 3590400*k**7 - 285120*k**9 + 240*k*(-1 + k**2)*(495 &
                  + 5060*k**2 + 8170*k**4 + 2340*k**6 + 63*k**8)*t - 480*k*(-1 + k**2)**2*(45 + 365*k**2 + 423*k**4 &
                  + 63*k**6)*t**2 + 80*k*(-1 + k**2)**3*(27 + 169*k**2 + 133*k**4 + 7*k**6)*t**3 - 40*k*(-1 + k**2)**4*(3 &
                  + 14*k**2 + 7*k**4)*t**4 + k*(-1 + k**2)**5*(3 + k**2)*(1 + 3*k**2)*t**5)*exp(-t) + (285120*k + 3590400*k**3 &
                  + 7731840*k**5 + 3590400*k**7 + 285120*k**9 + 240*(-1 + k**2)*(63 + 2340*k**2 + 8170*k**4 + 5060*k**6 &
                  + 495*k**8)*t + 480*k*(-1 + k**2)**2*(63 + 423*k**2 + 365*k**4 + 45*k**6)*t**2 + 80*(-1 + k**2)**3*(7 &
                  + 133*k**2 + 169*k**4 + 27*k**6)*t**3 + 40*k*(-1 + k**2)**4*(7 + 14*k**2 + 3*k**4)*t**4 + (-1 + k**2)**5*(3 &
                  + k**2)*(1 + 3*k**2)*t**5)*exp(-(k*t)))*sqrt(k))/(945*(-1 + k**2)**11*t)
endif

!*******************
case(1)   ! <s1|p2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) +  ((3274425*t**2 + 3274425*t**3 + 1600830*t**4 + 509355*t**5 + 118800*t**6 + 21780*t**7 + 3300*t**8 &
                  + 429*t**9 + 49*t**10 + 5*t**11)*exp(-t))/(16372125*t*sqrt(3.))
else

ovlp(0) = ovlp(0) + (128*k**5*((-285120 - 11278080*k**2 - 40579200*k**4 - 23212800*k**6 - 2059200*k**8 - 2880*(99 &
                  + 3916*k**2 + 14090*k**4 + 8060*k**6 + 715*k**8)*t + 1200*(-1 + k**2)*(81 + 2820*k**2 + 8750*k**4 &
                  + 4180*k**6 + 297*k**8)*t**2 - 480*(-1 + k**2)**2*(36 + 1051*k**2 + 2571*k**4 + 801*k**6 + 21*k**8)*t**3 &
                  + 600*(-1 + k**2)**3*(3 + 71*k**2 + 129*k**4 + 21*k**6)*t**4 - 4*(-1 + k**2)**4*(27 + 501*k**2 + 637*k**4 &
                  + 35*k**6)*t**5 + (-1 + k**2)**5*(3 + 42*k**2 + 35*k**4)*t**6)*exp(-t) + (285120 + 11278080*k**2 &
                  + 40579200*k**4 + 23212800*k**6 + 2059200*k**8 + 2880*k*(99 + 3916*k**2 + 14090*k**4 + 8060*k**6 &
                  + 715*k**8)*t + 240*(-1 + k**2)*(189 + 9396*k**2 + 40790*k**4 + 27460*k**6 + 2805*k**8)*t**2 &
                  + 480*k*(-1 + k**2)**2*(273 + 2097*k**2 + 1875*k**4 + 235*k**6)*t**3 + 840*(-1 + k**2)**3*(3 + 63*k**2 &
                  + 81*k**4 + 13*k**6)*t**4 + 200*k*(-1 + k**2)**4*(7 + 14*k**2 + 3*k**4)*t**5 + 5*(-1 + k**2)**5*(3 &
                  + k**2)*(1 + 3*k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(1575*sqrt(3.)*(-1 + k**2)**11*t**2)

endif

!*******************
case(2)   ! <s1|d2>
!*******************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(-291060 - 291060*t - 114345*t**2 - 17325*t**3 + 2475*t**4 + 1782*t**5 + 437*t**6 + 74*t**7 &
                  + 10*t**8)*exp(-t))/(19646550*sqrt(5.))
else

ovlp(0) = ovlp(0) + (128*k**5*((-17297280*k - 124225920*k**3 - 82857600*k**5 - 7862400*k**7 - 120960*k*(143 + 1027*k**2 &
                  + 685*k**4 + 65*k**6)*t + 960*k*(-7821 - 52744*k**2 - 23770*k**4 + 3200*k**6 + 495*k**8)*t**2 + 4800*k*(-1 &
                  + k**2)*(363 + 2285*k**2 + 1285*k**4 + 99*k**6)*t**3 - 1200*k*(-1 + k**2)**2*(201 + 1081*k**2 + 483*k**4 &
                  + 27*k**6)*t**4 + 16*k*(-1 + k**2)**3*(1287 + 5554*k**2 + 1531*k**4 + 28*k**6)*t**5 - 8*k*(-1 + k**2)**4*(129 &
                  + 422*k**2 + 49*k**4)*t**6 + 8*k*(-1 + k**2)**5*(3 + 7*k**2)*t**7)*exp(-t) + (17297280*k + 124225920*k**3 &
                  + 82857600*k**5 + 7862400*k**7 + 120960*k**2*(143 + 1027*k**2 + 685*k**4 + 65*k**6)*t + 3840*k*(-297 &
                  - 737*k**2 + 11329*k**4 + 8965*k**6 + 900*k**8)*t**2 + 1920*k**2*(-1 + k**2)*(594 + 5071*k**2 + 3980*k**4 &
                  + 435*k**6)*t**3 + 480*k*(-1 + k**2)**2*(189 + 2061*k**2 + 1975*k**4 + 255*k**6)*t**4 + 40*(-1 + k**2)**3*(49 &
                  + 1309*k**2 + 1723*k**4 + 279*k**6)*t**5 + 200*k*(-1 + k**2)**4*(7 + 14*k**2 + 3*k**4)*t**6 + 5*(-1 &
                  + k**2)**5*(3 + k**2)*(1 + 3*k**2)*t**7)*exp(-(k*t)))*sqrt(k))/(945*sqrt(5.)*(-1 + k**2)**11*t**3)

endif

!*********************
case(3)   ! <p1|s2>
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) +  ((3274425*t**2 + 3274425*t**3 + 1600830*t**4 + 509355*t**5 + 118800*t**6 + 21780*t**7 + 3300*t**8 &
                  + 429*t**9 + 49*t**10 + 5*t**11)*exp(-t))/(16372125*t*sqrt(3.))

else

ovlp(0) = ovlp(0) + (128*k**5*((-285120 - 11278080*k**2 - 40579200*k**4 - 23212800*k**6 - 2059200*k**8 - 2880*(99 &
                  + 3916*k**2 + 14090*k**4 + 8060*k**6 + 715*k**8)*t + 1200*(-1 + k**2)*(81 + 2820*k**2 + 8750*k**4 &
                  + 4180*k**6 + 297*k**8)*t**2 - 480*(-1 + k**2)**2*(36 + 1051*k**2 + 2571*k**4 + 801*k**6 + 21*k**8)*t**3 &
                  + 600*(-1 + k**2)**3*(3 + 71*k**2 + 129*k**4 + 21*k**6)*t**4 - 4*(-1 + k**2)**4*(27 + 501*k**2 + 637*k**4 &
                  + 35*k**6)*t**5 + (-1 + k**2)**5*(3 + 42*k**2 + 35*k**4)*t**6)*exp(-t) + (285120 + 11278080*k**2 &
                  + 40579200*k**4 + 23212800*k**6 + 2059200*k**8 + 2880*k*(99 + 3916*k**2 + 14090*k**4 + 8060*k**6 &
                  + 715*k**8)*t + 240*(-1 + k**2)*(189 + 9396*k**2 + 40790*k**4 + 27460*k**6 + 2805*k**8)*t**2 &
                  + 480*k*(-1 + k**2)**2*(273 + 2097*k**2 + 1875*k**4 + 235*k**6)*t**3 + 840*(-1 + k**2)**3*(3 + 63*k**2 &
                  + 81*k**4 + 13*k**6)*t**4 + 200*k*(-1 + k**2)**4*(7 + 14*k**2 + 3*k**4)*t**5 + 5*(-1 + k**2)**5*(3 &
                  + k**2)*(1 + 3*k**2)*t**6)*exp(-(k*t)))*sqrt(k))/(1575*sqrt(3.)*(-1 + k**2)**11*t**2)

endif

!*********************************
case(4)   ! l1 = l2 = 1 => <p1|p2>
!*********************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((16372125*t + 16372125*t**2 + 7203735*t**3 + 1746360*t**4 + 212355*t**5 - 5940*t**6 - 8052*t**7 &
                  - 1914*t**8 - 318*t**9 - 43*t**10 - 5*t**11)*exp(-t))/(16372125*t)
ovlp(1) = ovlp(1) - ((-16372125*t - 16372125*t**2 - 7858620*t**3 - 2401245*t**4 - 522720*t**5 - 86130*t**6 - 11154*t**7 &
                  - 1155*t**8 - 93*t**9 - 5*t**10)*exp(-t))/(16372125*t)
else

ovlp(0) = ovlp(0) + (-128*k**5*((-823680 - 30251520*k**2 - 92678400*k**4 - 30251520*k**6 - 823680*k**8 - 5760*(143 + 5252*k**2 &
                  + 16090*k**4 + 5252*k**6 + 143*k**8)*t - 2880*(143 + 5252*k**2 + 16090*k**4 + 5252*k**6 + 143*k**8)*t**2 &
                  + 240*(-1 + k**2)*(467 + 15700*k**2 + 45410*k**4 + 17908*k**6 + 1155*k**8)*t**3 - 48*(-1 + k**2)**2*(379 &
                  + 10914*k**2 + 25944*k**4 + 7374*k**6 + 189*k**8)*t**4 + 96*(-1 + k**2)**3*(19 + 448*k**2 + 807*k**4 &
                  + 126*k**6)*t**5 - 4*(-1 + k**2)**4*(27 + 501*k**2 + 637*k**4 + 35*k**6)*t**6 + (-1 + k**2)**5*(3 + 42*k**2 &
                  + 35*k**4)*t**7)*exp(-t) + (823680 + 30251520*k**2 + 92678400*k**4 + 30251520*k**6 + 823680*k**8 + 5760*k*(143 &
                  + 5252*k**2 + 16090*k**4 + 5252*k**6 + 143*k**8)*t + 2880*k**2*(143 + 5252*k**2 + 16090*k**4 + 5252*k**6 &
                  + 143*k**8)*t**2 + 240*k*(-1 + k**2)*(1155 + 17908*k**2 + 45410*k**4 + 15700*k**6 + 467*k**8)*t**3 + 48*(-1 &
                  + k**2)**2*(189 + 7374*k**2 + 25944*k**4 + 10914*k**6 + 379*k**8)*t**4 + 96*k*(-1 + k**2)**3*(126 + 807*k**2 &
                  + 448*k**4 + 19*k**6)*t**5 + 4*(-1 + k**2)**4*(35 + 637*k**2 + 501*k**4 + 27*k**6)*t**6 + k*(-1 + k**2)**5*(35 &
                  + 42*k**2 + 3*k**4)*t**7)*exp(-(k*t)))*sqrt(k))/(1575*(-1 + k**2)**11*t**3)

ovlp(1) = ovlp(1) + (128*k**5*((-411840 - 15125760*k**2 - 46339200*k**4 - 15125760*k**6 - 411840*k**8 - 2880*(143 + 5252*k**2 &
                  + 16090*k**4 + 5252*k**6 + 143*k**8)*t + 720*(-1 + k**2)*(187 + 6060*k**2 + 16090*k**4 + 4444*k**6 &
                  + 99*k**8)*t**2 - 480*(-1 + k**2)**2*(47 + 1287*k**2 + 2717*k**4 + 429*k**6)*t**3 + 24*(-1 + k**2)**3*(91 &
                  + 2047*k**2 + 3273*k**4 + 189*k**6)*t**4 - 120*(-1 + k**2)**4*(1 + 18*k**2 + 21*k**4)*t**5 + (-1 + k**2)**5*(3 &
                  + 42*k**2 + 35*k**4)*t**6)*exp(-t) + (411840 + 15125760*k**2 + 46339200*k**4 + 15125760*k**6 + 411840*k**8 &
                  + 2880*k*(143 + 5252*k**2 + 16090*k**4 + 5252*k**6 + 143*k**8)*t + 720*(-1 + k**2)*(99 + 4444*k**2 &
                  + 16090*k**4 + 6060*k**6 + 187*k**8)*t**2 + 480*k*(-1 + k**2)**2*(429 + 2717*k**2 + 1287*k**4 + 47*k**6)*t**3 &
                  + 24*(-1 + k**2)**3*(189 + 3273*k**2 + 2047*k**4 + 91*k**6)*t**4 + 120*k*(-1 + k**2)**4*(21 + 18*k**2 &
                  + k**4)*t**5 + (-1 + k**2)**5*(35 + 42*k**2 + 3*k**4)*t**6)*exp(-(k*t)))*sqrt(k))/(1575*(-1 + k**2)**11*t**3)

endif

!***************************************
case(5)   ! l1 = 1 and l2 = 2 => <p1|d2>
!***************************************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((5239080*t**2 + 5239080*t**3 + 2411640*t**4 + 665280*t**5 + 117315*t**6 + 11979*t**7 + 42*t**8 &
                  - 255*t**9 - 62*t**10 - 10*t**11)*exp(-t))/(6548850*t*sqrt(15.))
ovlp(1) = ovlp(1) + ((2619540*t**2 + 2619540*t**3 + 1257795*t**4 + 384615*t**5 + 83655*t**6 + 13662*t**7 + 1713*t**8 &
                  + 162*t**9 + 10*t**10)*exp(-t))/(6548850*t*sqrt(5.))

else

ovlp(0) = ovlp(0) + (-128*k**5*((-70761600*k - 455414400*k**3 - 165836160*k**5 - 4717440*k**7 - 362880*k*(195 + 1255*k**2 &
                  + 457*k**4 + 13*k**6)*t + 2880*k*(-11713 - 73982*k**2 - 22496*k**4 + 638*k**6 + 33*k**8)*t**2 + 2880*k*(-3523 &
                  - 21272*k**2 - 3302*k**4 + 1184*k**6 + 33*k**8)*t**3 + 240*k*(-1 + k**2)*(8259 + 49060*k**2 + 21386*k**4 &
                  + 1908*k**6 + 27*k**8)*t**4 - 240*k*(-1 + k**2)**2*(1055 + 5535*k**2 + 2229*k**4 + 141*k**6)*t**5 + 24*k*(-1 &
                  + k**2)**3*(869 + 3723*k**2 + 987*k**4 + 21*k**6)*t**6 - 8*k*(-1 + k**2)**4*(129 + 422*k**2 + 49*k**4)*t**7 &
                  + 8*k*(-1 + k**2)**5*(3 + 7*k**2)*t**8)*exp(-t) + (70761600*k + 455414400*k**3 + 165836160*k**5 + 4717440*k**7 &
                  + 362880*k**2*(195 + 1255*k**2 + 457*k**4 + 13*k**6)*t + 5760*k*(-286 + 3601*k**2 + 36385*k**4 + 13667*k**6 &
                  + 393*k**8)*t**2 + 11520*k**2*(-143 - 247*k**2 + 5015*k**4 + 2035*k**6 + 60*k**8)*t**3 + 480*k*(-1 + k**2)*(297 &
                  + 5896*k**2 + 24350*k**4 + 9480*k**6 + 297*k**8)*t**4 + 48*(-1 + k**2)**2*(147 + 6102*k**2 + 26412*k**4 &
                  + 11722*k**6 + 417*k**8)*t**5 + 48*k*(-1 + k**2)**3*(231 + 1617*k**2 + 913*k**4 + 39*k**6)*t**6 + 4*(-1 &
                  + k**2)**4*(35 + 637*k**2 + 501*k**4 + 27*k**6)*t**7 + k*(-1 + k**2)**5*(35 + 42*k**2 &
                  + 3*k**4)*t**8)*exp(-(k*t)))*sqrt(k))/(315*sqrt(15.)*(-1 + k**2)**11*t**4)

ovlp(1) = ovlp(1) + (128*k**5*((-23587200*k - 151804800*k**3 - 55278720*k**5 - 1572480*k**7 - 120960*k*(195 + 1255*k**2 &
                  + 457*k**4 + 13*k**6)*t + 2880*k*(-3523 - 21272*k**2 - 3302*k**4 + 1184*k**6 + 33*k**8)*t**2 + 2880*k*(-1 &
                  + k**2)*(793 + 4495*k**2 + 1399*k**4 + 33*k**6)*t**3 - 240*k*(-1 + k**2)**2*(1257 + 6137*k**2 + 1539*k**4 &
                  + 27*k**6)*t**4 + 240*k*(-1 + k**2)**3*(101 + 402*k**2 + 57*k**4)*t**5 - 24*k*(-1 + k**2)**4*(47 + 146*k**2 &
                  + 7*k**4)*t**6 + 8*k*(-1 + k**2)**5*(3 + 7*k**2)*t**7)*exp(-t) + (23587200*k + 151804800*k**3 + 55278720*k**5 &
                  + 1572480*k**7 + 120960*k**2*(195 + 1255*k**2 + 457*k**4 + 13*k**6)*t + 11520*k*(-143 - 247*k**2 + 5015*k**4 &
                  + 2035*k**6 + 60*k**8)*t**2 + 5760*k**2*(-1 + k**2)*(286 + 2145*k**2 + 900*k**4 + 29*k**6)*t**3 &
                  + 480*k*(-1 + k**2)**2*(297 + 2761*k**2 + 1371*k**4 + 51*k**6)*t**4 + 24*(-1 + k**2)**3*(147 + 3279*k**2 &
                  + 2081*k**4 + 93*k**6)*t**5 + 120*k*(-1 + k**2)**4*(21 + 18*k**2 + k**4)*t**6 + (-1 + k**2)**5*(35 + 42*k**2 &
                  + 3*k**4)*t**7)*exp(-(k*t)))*sqrt(k))/(315*sqrt(5.)*(-1 + k**2)**11*t**4)

endif

!********************
case(6)   ! <d1|s2>
!********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + (t**2*(-291060 - 291060*t - 114345*t**2 - 17325*t**3 + 2475*t**4 + 1782*t**5 + 437*t**6 + 74*t**7 &
                  + 10*t**8)*exp(-t))/(19646550*sqrt(5.))
else

ovlp(0) = ovlp(0) + (128*k**5*((-17297280*k - 124225920*k**3 - 82857600*k**5 - 7862400*k**7 - 120960*k*(143 + 1027*k**2 &
                  + 685*k**4 + 65*k**6)*t + 960*k*(-7821 - 52744*k**2 - 23770*k**4 + 3200*k**6 + 495*k**8)*t**2 + 4800*k*(-1 &
                  + k**2)*(363 + 2285*k**2 + 1285*k**4 + 99*k**6)*t**3 - 1200*k*(-1 + k**2)**2*(201 + 1081*k**2 + 483*k**4 &
                  + 27*k**6)*t**4 + 16*k*(-1 + k**2)**3*(1287 + 5554*k**2 + 1531*k**4 + 28*k**6)*t**5 - 8*k*(-1 + k**2)**4*(129 &
                  + 422*k**2 + 49*k**4)*t**6 + 8*k*(-1 + k**2)**5*(3 + 7*k**2)*t**7)*exp(-t) + (17297280*k + 124225920*k**3 &
                  + 82857600*k**5 + 7862400*k**7 + 120960*k**2*(143 + 1027*k**2 + 685*k**4 + 65*k**6)*t + 3840*k*(-297 &
                  - 737*k**2 + 11329*k**4 + 8965*k**6 + 900*k**8)*t**2 + 1920*k**2*(-1 + k**2)*(594 + 5071*k**2 + 3980*k**4 &
                  + 435*k**6)*t**3 + 480*k*(-1 + k**2)**2*(189 + 2061*k**2 + 1975*k**4 + 255*k**6)*t**4 + 40*(-1 + k**2)**3*(49 &
                  + 1309*k**2 + 1723*k**4 + 279*k**6)*t**5 + 200*k*(-1 + k**2)**4*(7 + 14*k**2 + 3*k**4)*t**6 + 5*(-1 &
                  + k**2)**5*(3 + k**2)*(1 + 3*k**2)*t**7)*exp(-(k*t)))*sqrt(k))/(945*sqrt(5.)*(-1 + k**2)**11*t**3)

endif

!*********************
case(7)  ! <d1|p2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((5239080*t**2 + 5239080*t**3 + 2411640*t**4 + 665280*t**5 + 117315*t**6 + 11979*t**7 + 42*t**8 &
                  - 255*t**9 - 62*t**10 - 10*t**11)*exp(-t))/(6548850*t*sqrt(15.))
ovlp(1) = ovlp(1) + ((2619540*t**2 + 2619540*t**3 + 1257795*t**4 + 384615*t**5 + 83655*t**6 + 13662*t**7 + 1713*t**8 &
                  + 162*t**9 + 10*t**10)*exp(-t))/(6548850*t*sqrt(5.))

else

ovlp(0) = ovlp(0) + (-128*k**5*((-70761600*k - 455414400*k**3 - 165836160*k**5 - 4717440*k**7 - 362880*k*(195 + 1255*k**2 &
                  + 457*k**4 + 13*k**6)*t + 2880*k*(-11713 - 73982*k**2 - 22496*k**4 + 638*k**6 + 33*k**8)*t**2 + 2880*k*(-3523 &
                  - 21272*k**2 - 3302*k**4 + 1184*k**6 + 33*k**8)*t**3 + 240*k*(-1 + k**2)*(8259 + 49060*k**2 + 21386*k**4 &
                  + 1908*k**6 + 27*k**8)*t**4 - 240*k*(-1 + k**2)**2*(1055 + 5535*k**2 + 2229*k**4 + 141*k**6)*t**5 + 24*k*(-1 &
                  + k**2)**3*(869 + 3723*k**2 + 987*k**4 + 21*k**6)*t**6 - 8*k*(-1 + k**2)**4*(129 + 422*k**2 + 49*k**4)*t**7 &
                  + 8*k*(-1 + k**2)**5*(3 + 7*k**2)*t**8)*exp(-t) + (70761600*k + 455414400*k**3 + 165836160*k**5 + 4717440*k**7 &
                  + 362880*k**2*(195 + 1255*k**2 + 457*k**4 + 13*k**6)*t + 5760*k*(-286 + 3601*k**2 + 36385*k**4 + 13667*k**6 &
                  + 393*k**8)*t**2 + 11520*k**2*(-143 - 247*k**2 + 5015*k**4 + 2035*k**6 + 60*k**8)*t**3 + 480*k*(-1 + k**2)*(297 &
                  + 5896*k**2 + 24350*k**4 + 9480*k**6 + 297*k**8)*t**4 + 48*(-1 + k**2)**2*(147 + 6102*k**2 + 26412*k**4 &
                  + 11722*k**6 + 417*k**8)*t**5 + 48*k*(-1 + k**2)**3*(231 + 1617*k**2 + 913*k**4 + 39*k**6)*t**6 + 4*(-1 &
                  + k**2)**4*(35 + 637*k**2 + 501*k**4 + 27*k**6)*t**7 + k*(-1 + k**2)**5*(35 + 42*k**2 &
                  + 3*k**4)*t**8)*exp(-(k*t)))*sqrt(k))/(315*sqrt(15.)*(-1 + k**2)**11*t**4)

ovlp(1) = ovlp(1) + (128*k**5*((-23587200*k - 151804800*k**3 - 55278720*k**5 - 1572480*k**7 - 120960*k*(195 + 1255*k**2 &
                  + 457*k**4 + 13*k**6)*t + 2880*k*(-3523 - 21272*k**2 - 3302*k**4 + 1184*k**6 + 33*k**8)*t**2 + 2880*k*(-1 &
                  + k**2)*(793 + 4495*k**2 + 1399*k**4 + 33*k**6)*t**3 - 240*k*(-1 + k**2)**2*(1257 + 6137*k**2 + 1539*k**4 &
                  + 27*k**6)*t**4 + 240*k*(-1 + k**2)**3*(101 + 402*k**2 + 57*k**4)*t**5 - 24*k*(-1 + k**2)**4*(47 + 146*k**2 &
                  + 7*k**4)*t**6 + 8*k*(-1 + k**2)**5*(3 + 7*k**2)*t**7)*exp(-t) + (23587200*k + 151804800*k**3 + 55278720*k**5 &
                  + 1572480*k**7 + 120960*k**2*(195 + 1255*k**2 + 457*k**4 + 13*k**6)*t + 11520*k*(-143 - 247*k**2 + 5015*k**4 &
                  + 2035*k**6 + 60*k**8)*t**2 + 5760*k**2*(-1 + k**2)*(286 + 2145*k**2 + 900*k**4 + 29*k**6)*t**3 &
                  + 480*k*(-1 + k**2)**2*(297 + 2761*k**2 + 1371*k**4 + 51*k**6)*t**4 + 24*(-1 + k**2)**3*(147 + 3279*k**2 &
                  + 2081*k**4 + 93*k**6)*t**5 + 120*k*(-1 + k**2)**4*(21 + 18*k**2 + k**4)*t**6 + (-1 + k**2)**5*(35 + 42*k**2 &
                  + 3*k**4)*t**7)*exp(-(k*t)))*sqrt(k))/(315*sqrt(5.)*(-1 + k**2)**11*t**4)

endif

!*********************
case(8)  ! <d1|d2> 
!*********************

if(k.eq.1) then
ovlp(0) = ovlp(0) + ((9823275*t + 9823275*t**2 + 3939705*t**3 + 665280*t**4 - 41580*t**5 - 45045*t**6 - 10125*t**7 &
                  - 1116*t**8 - 23*t**9 + 19*t**10 + 5*t**11)*exp(-t))/(9823275*t)
ovlp(1) = ovlp(1) - ((-3274425*t - 3274425*t**2 - 1372140*t**3 - 280665*t**4 - 10395*t**5 + 10395*t**6 + 3360*t**7 + 588*t**8 &
                  + 69*t**9 + 5*t**10)*exp(-t))/(3274425*t)
ovlp(2) = ovlp(2) + ((3274425*t + 3274425*t**2 + 1548855*t**3 + 457380*t**4 + 93555*t**5 + 13860*t**6 + 1500*t**7 + 114*t**8 &
                  + 5*t**9)*exp(-t))/(3274425*t)

else

ovlp(0) = ovlp(0) +  (1024*k**5*((-65318400*k - 391910400*k**3 - 65318400*k**5 - 65318400*k*(1 + 6*k**2 + k**4)*t &
                  + 120960*k*(-257 - 1513*k**2 - 163*k**4 + 13*k**6)*t**2 + 120960*k*(-77 - 433*k**2 + 17*k**4 &
                  + 13*k**6)*t**3 - 480*k*(4131 + 21724*k**2 - 5342*k**4 - 452*k**6 + 99*k**8)*t**4 + 30*k*(-1 + k**2)*(10299 &
                  + 55840*k**2 + 12494*k**4 + 1944*k**6 + 63*k**8)*t**5 - 30*k*(-1 + k**2)**2*(1155 + 5795*k**2 + 1857*k**4 &
                  + 153*k**6)*t**6 + k*(-1 + k**2)**3*(2673 + 11291*k**2 + 2759*k**4 + 77*k**6)*t**7 - k*(-1 + k**2)**4*(129 &
                  + 422*k**2 + 49*k**4)*t**8 + k*(-1 + k**2)**5*(3 + 7*k**2)*t**9)*exp(-t) + (65318400*k + 391910400*k**3 &
                  + 65318400*k**5 + 65318400*k**2*(1 + 6*k**2 + k**4)*t + 120960*k*(-13 + 163*k**2 + 1513*k**4 + 257*k**6)*t**2 &
                  + 120960*k**2*(-13 - 17*k**2 + 433*k**4 + 77*k**6)*t**3 + 480*k*(99 - 452*k**2 - 5342*k**4 + 21724*k**6 &
                  + 4131*k**8)*t**4 + 30*(-1 + k**2)*(63 + 1944*k**2 + 12494*k**4 + 55840*k**6 + 10299*k**8)*t**5 + 30*k*(-1 &
                  + k**2)**2*(153 + 1857*k**2 + 5795*k**4 + 1155*k**6)*t**6 + (-1 + k**2)**3*(77 + 2759*k**2 + 11291*k**4 &
                  + 2673*k**6)*t**7 + k*(-1 + k**2)**4*(49 + 422*k**2 + 129*k**4)*t**8 + k**2*(-1 + k**2)**5*(7 &
                  + 3*k**2)*t**9)*exp(-(k*t)))*sqrt(k))/(945*(-1 + k**2)**11*t**5) 
 
ovlp(1) = ovlp(1) + (-1024*k**5*((-14515200*k - 87091200*k**3 - 14515200*k**5 - 14515200*k*(1 + 6*k**2 + k**4)*t + 40320*k*(-167 &
                - 973*k**2 - 73*k**4 + 13*k**6)*t**2 + 40320*k*(-47 - 253*k**2 + 47*k**4 + 13*k**6)*t**3 + 20160*k*(-1 &
                + k**2)*(17 + 90*k**2 + 13*k**4)*t**4 - 210*k*(-1 + k**2)**2*(193 + 913*k**2 + 171*k**4 + 3*k**6)*t**5 &
                + 30*k*(-1 + k**2)**3*(103 + 406*k**2 + 51*k**4)*t**6 - 3*k*(-1 + k**2)**4*(47 + 146*k**2 + 7*k**4)*t**7 &
                + k*(-1 + k**2)**5*(3 + 7*k**2)*t**8)*exp(-t) + (14515200*k + 87091200*k**3 + 14515200*k**5 + 14515200*k**2*(1 &
                + 6*k**2 + k**4)*t + 40320*k*(-13 + 73*k**2 + 973*k**4 + 167*k**6)*t**2 + 40320*k**2*(-13 - 47*k**2 + 253*k**4 &
                + 47*k**6)*t**3 + 20160*k**3*(-1 + k**2)*(13 + 90*k**2 + 17*k**4)*t**4 + 210*(-1 + k**2)**2*(3 + 171*k**2 &
                + 913*k**4 + 193*k**6)*t**5 + 30*k*(-1 + k**2)**3*(51 + 406*k**2 + 103*k**4)*t**6 + 3*(-1 + k**2)**4*(7 &
                + 146*k**2 + 47*k**4)*t**7 + k*(-1 + k**2)**5*(7 + 3*k**2)*t**8)*exp(-(k*t)))*sqrt(k))/(315*(-1 + k**2)**11*t**5)

ovlp(2) = ovlp(2) + (1024*k**5*((-3628800*k - 21772800*k**3 - 3628800*k**5 - 3628800*k*(1 + 6*k**2 + k**4)*t + 20160*k*(-77 &
                - 433*k**2 + 17*k**4 + 13*k**6)*t**2 + 20160*k*(-1 + k**2)*(17 + 90*k**2 + 13*k**4)*t**3 - 240*k*(-1 &
                + k**2)**2*(183 + 838*k**2 + 99*k**4)*t**4 + 30*k*(-1 + k**2)**3*(113 + 426*k**2 + 21*k**4)*t**5 - 150*k*(-1 &
                + k**2)**4*(1 + 3*k**2)*t**6 + k*(-1 + k**2)**5*(3 + 7*k**2)*t**7)*exp(-t) + (3628800*k + 21772800*k**3 &
                + 3628800*k**5 + 3628800*k**2*(1 + 6*k**2 + k**4)*t + 20160*k*(-13 - 17*k**2 + 433*k**4 + 77*k**6)*t**2 &
                + 20160*k**2*(-1 + k**2)*(13 + 90*k**2 + 17*k**4)*t**3 + 240*k*(-1 + k**2)**2*(99 + 838*k**2 + 183*k**4)*t**4 &
                + 30*(-1 + k**2)**3*(21 + 426*k**2 + 113*k**4)*t**5 + 150*k*(-1 + k**2)**4*(3 + k**2)*t**6 + (-1 + k**2)**5*(7 &
                + 3*k**2)*t**7)*exp(-(k*t)))*sqrt(k))/(315*(-1 + k**2)**11*t**5)

endif

end select

! ---------------- End of Select case over NNSEL -------------------------------

end select

! ------------------------------------------------------------------------------

! Correcting the signal, in the case of interchange due the n1 >= n2 imposition:

ovlp(0) = f*ovlp(0)
ovlp(1) = f*ovlp(1)
ovlp(2) = f*ovlp(2)

! End of the subroutine:

end subroutine overlap

!-----------------------------------------------------------------------
!
! Given two l-shells li,lj, centered at atoms ri and rj, this subroutine
! generates all the < ljm | lim > by applying the two-center SK formulas
! 
! Input:
!
!   ovin: sigma, pi & delta components for current <li|lj> interaction
!         (they may correspond to the overlap or the Hamiltonian)
!   cl  : (xj-xi)/|rj-ri|
!   cm  : (yj-yi)/|rj-ri|
!   cn  : (zj-zi)/|rj-ri|
!   cl2,cm2,cn2: squares of the direction cosines cl,cm,cn
!   
!
! Output:
!   ovout: overlap/Hamiltonian elements are given in ovout
!
! Care with signs:
!
! ----------------------------------------------------------------------

subroutine twocenter(li,lj,ovin,ovout,cl,cl2,cm,cm2,cn,cn2)

      implicit none

      integer , intent(in) :: li,lj
      real*8,  intent(in)  :: ovin(3) , cl , cl2 , cm , cm2 , cn ,cn2
      real*8,  intent(out) :: ovout(25)

      integer  :: itype
      integer  :: kao2(0:2,0:2)
      real*8   :: sqr3
      data kao2 / 0 , 3 , 6 , 1 , 4 , 7 , 2 , 5 , 8 /

! ----------------------------------------------------------------------

      sqr3 = sqrt(3.)
      itype = kao2(li,lj)

      select case(itype)

! --  itype = 0 => (S(I):S(J))
      case(0)
        ovout(1)= ovin(1)

! --  itype = 1 => (S(I):P(J))
      case(1)
        ovout(1) = cl*ovin(1)                           ! s,px
        ovout(2) = cm*ovin(1)                           ! s,py
        ovout(3) = cn*ovin(1)                           ! s,pz

! --  itype = 2 => (S(I):D(J))
      case(2)
        ovout(1) = 0.5d0*sqr3*(cl2-cm2)   * ovin(1)     ! s,dx2-y2
        ovout(2) = (cn2-0.5d0*(cl2+cm2))  * ovin(1)     ! s,dz2
        ovout(3) = sqr3*cl*cm             * ovin(1)     ! s,dxy
        ovout(4) = sqr3*cn*cl             * ovin(1)     ! s,dzx
        ovout(5) = sqr3*cm*cn             * ovin(1)     ! s,dyz

! --  itype = 3 => (P(I):S(J))  ! Signal changed here!!!
      case(3)
        ovout(1) =+cl*ovin(1)                           ! px,s
        ovout(2) =+cm*ovin(1)                           ! py,s
        ovout(3) =+cn*ovin(1)                           ! pz,s

! --  itype = 4 => (P(I):P(J))
      case(4)
        ovout(1) =   cl2*ovin(1) + (1.0d0-cl2)*ovin(2)  ! px,px
        ovout(2) = cm*cl*ovin(1) - cm*cl* ovin(2)       ! py,px
        ovout(3) = cn*cl*ovin(1) - cn*cl* ovin(2)       ! pz,px
        ovout(4) = ovout(2)                             ! px,py
        ovout(5) =   cm2*ovin(1) + (1.0d0-cm2)*ovin(2)  ! py,py
        ovout(6) = cn*cm*ovin(1) - cn*cm*ovin(2)        ! pz,py
        ovout(7) = ovout(3)                             ! px,pz
        ovout(8) = ovout(6)                             ! py,pz
        ovout(9) =   cn2*ovin(1) + (1.0d0-cn2)*ovin(2)  ! pz,pz

! --  itype = 5 => (P(I):D(J))
      case(5)
        ovout( 1)= 0.5d0*sqr3*cl*(cl2-cm2)*ovin(1)  + cl*(1.0d0-cl2+cm2)*ovin(2)  ! px,dx2
        ovout( 2)= 0.5d0*sqr3*cm*(cl2-cm2)*ovin(1)  - cm*(1.0d0+cl2-cm2)*ovin(2)  ! py,dx2
        ovout( 3)= 0.5d0*sqr3*cn*(cl2-cm2)*ovin(1)  - cn*(cl2-cm2)*ovin(2)        ! pz,dx2
        ovout( 4)= cl*(cn2-0.5d0*(cl2+cm2))*ovin(1) - sqr3*cl*cn2*ovin(2)         ! px,dz2
        ovout( 5)= cm*(cn2-0.5d0*(cl2+cm2))*ovin(1) - sqr3*cm*cn2* ovin(2)        ! py,dz2
        ovout( 6)= cn*(cn2-0.5d0*(cl2+cm2))*ovin(1) + sqr3*cn*(cl2+cm2)* ovin(2)  ! pz,dz2
        ovout( 7)= sqr3*cl2*cm*ovin(1) + cm*(1.0d0-2.0d0*cl2)* ovin(2)            ! pxdxy
        ovout( 8)= sqr3*cm2*cl*ovin(1) + cl*(1.0d0-2.0d0*cm2)* ovin(2)            ! pydxy
        ovout( 9)= sqr3*cl*cm*cn*ovin(1) - 2.0d0*cl*cm*cn* ovin(2)                ! pzdxy
        ovout(10)= sqr3*cl2*cn*ovin(1) + cn*(1.0d0-2.0d0*cl2)* ovin(2)            ! px,dzx
        ovout(11)= ovout(9)                                                       ! py,dzx
        ovout(12)= sqr3*cn2*cl*ovin(1) + cl*(1.0d0-2.0d0*cn2)* ovin(2)            ! pz,dzx
        ovout(13)= ovout(9)                                                       ! px,dyz
        ovout(14)= sqr3*cm2*cn*ovin(1) + cn*(1.0d0-2.0d0*cm2)* ovin(2)            ! py,dyz
        ovout(15)= sqr3*cn2*cm*ovin(1) + cm*(1.0d0-2.0d0*cn2)* ovin(2)            ! py,dyz

! --  itype = 6 => (D(I):S(J))
      case(6)
        ovout(1) =  0.5d0*sqr3*(cl2-cm2)  * ovin(1)    ! s,dx2
        ovout(2) = (cn2-0.5d0*(cl2+cm2))  * ovin(1)    ! s,dz2
        ovout(3) = sqr3*cl*cm             * ovin(1)    ! s,dxy
        ovout(4) = sqr3*cn*cl             * ovin(1)    ! s,dzx
        ovout(5) = sqr3*cm*cn             * ovin(1)    ! s,dyz

! --  itype = 7 => (D(I):P(J))   ! Signals changed here too
      case(7)
        ovout( 1) =-(-0.5d0*sqr3*cl*(cl2-cm2)*ovin(1) - cl*(1.0d0-cl2+cm2)*ovin(2))   ! dx2,px
        ovout( 2) =-(-cl*(cn2-0.5d0*(cl2+cm2))*ovin(1) + sqr3*cl*cn2*ovin(2)      )   ! dz2,px
        ovout( 3) =-(-sqr3*cl2*cm*ovin(1) - cm*(1.0d0-2.0d0*cl2)*ovin(2)          )   ! dxy,px
        ovout( 4) =-(-sqr3*cl2*cn*ovin(1) - cn*(1.0d0-2.0d0*cl2)*ovin(2)          )   ! dzx,px
        ovout( 5) =-(-sqr3*cl*cm*cn*ovin(1) + 2.0d0*cl*cm*cn*ovin(2)              )   ! dyz,px
        ovout( 6) =-(-0.5d0*sqr3*cm*(cl2-cm2)*ovin(1) + cm*(1.0d0+cl2-cm2)*ovin(2))   ! dx2,py
        ovout( 7) =-(-cm*(cn2-0.5d0*(cl2+cm2))*ovin(1) + sqr3*cm*cn2*ovin(2)      )   ! dz2,py
        ovout( 8) =-(-sqr3*cm2*cl*ovin(1) - cl*(1.0d0-2.0d0*cm2)*ovin(2)          )   ! dxy,py
        ovout( 9) = ovout(5)                                                          ! dzx,py
        ovout(10) =-(-sqr3*cm2*cn*ovin(1) - cn*(1.0d0-2.0d0*cm2)*ovin(2)          )   ! dyz,py
        ovout(11) =-(-0.5d0*sqr3*cn*(cl2-cm2)*ovin(1) + cn*(cl2-cm2)*ovin(2)      )   ! dx2,pz
        ovout(12) =-(-cn*(cn2-0.5d0*(cl2+cm2))*ovin(1) - sqr3*cn*(cl2+cm2)*ovin(2))   ! dz2,pz
        ovout(13) = ovout(5)                                                          ! dxy,pz
        ovout(14) =-(-sqr3*cn2*cl*ovin(1) - cl*(1.0d0-2.0d0*cn2)*ovin(2)          )   ! dzx,pz
        ovout(15) =-(-sqr3*cn2*cm*ovin(1) - cm*(1.0d0-2.0d0*cn2)*ovin(2)          )   ! dyz,pz

! --  itype = 8 =>  (D(I):D(J))
      case(8)
        ovout( 1)= 0.75d0*((cl2-cm2)**2)*ovin(1) + (cl2+cm2-(cl2-cm2)**2)*ovin(2) &
                  + (cn2+0.25*(cl2-cm2)**2)*ovin(3)                                      ! dx2,dx2
        ovout( 2)= 0.5d0*sqr3*(cl2-cm2)*(cn2-0.5d0*(cl2+cm2))*ovin(1) &
                  + sqr3*cn2*(cm2-cl2)*ovin(2) + (0.25*sqr3)*(1.+cn2)*(cl2-cm2)*ovin(3)  ! dz2,dx2
        ovout( 3)= 1.5d0*cl*cm*(cl2-cm2)*ovin(1) + 2.0d0*cl*cm*(cm2-cl2)*ovin(2) &
                  + 0.5d0*cl*cm*(cl2-cm2)*ovin(3)                                        ! dxy,dx2
        ovout( 4)= 1.5d0*cn*cl*(cl2-cm2)*ovin(1) + cn*cl*(1. - 2.*(cl2-cm2))*ovin(2) &
                  - cn*cl*(1.0d0-0.5d0*(cl2-cm2))*ovin(3)                                ! dzx,dx2
        ovout( 5)= 1.5d0*cm*cn*(cl2-cm2)*ovin(1) - cm*cn*(1. + 2.*(cl2-cm2))*ovin(2) &
                  + cm*cn*(1.0d0+0.5d0*(cl2-cm2))*ovin(3)                                ! dyz,dx2
        ovout( 6)= ovout(2)                                                              ! dx2,dz2 = dz2,dx2
        ovout( 7)= (cn2-0.5d0*(cl2+cm2))**2*ovin(1) + 3.0d0*cn2*(cl2+cm2)*ovin(2) &
                  +0.75d0*(cl2+cm2)**2*ovin(3)                                          ! dz2,dz2

        ovout( 8)= sqr3*cl*cm*(cn2-0.5*(cl2+cm2))*ovin(1) - sqr3*2.*cl*cm*cn2*ovin(2) &
                  +0.5d0*sqr3*cl*cm*(1.0d0+cn2)*ovin(3)                                 ! dxy,dz2
        ovout( 9)= sqr3*cl*cn*(cn2-0.5*(cl2+cm2))*ovin(1) &
                  +sqr3*cl*cn*(cl2+cm2-cn2)*ovin(2) - 0.5*sqr3*cl*cn*(cl2+cm2)*ovin(3)  ! dzx,dz2
        ovout(10) = sqr3*cm*cn*(cn2-0.5d0*(cl2+cm2))*ovin(1) &
                   +sqr3*cm*cn*(cl2+cm2-cn2)*ovin(2)- 0.5*sqr3*cm*cn*(cl2+cm2)*ovin(3)  ! dyz,dz2
        ovout(11)= ovout(3)                                                             ! dx2,dxy = dxy,dx2
        ovout(12)= ovout(8)                                                             ! dz2,dxy = dxy,dz2
        ovout(13)= 3.0d0*cl2*cm2*ovin(1) + (cl2+cm2-4.0d0*cl2*cm2)*ovin(2) &
                  + (cn2+cl2*cm2)*ovin(3)                                               ! dxy,dxy
        ovout(14)= 3.0d0*cn*cl2*cm*ovin(1) + cn*cm*(1.0d0-4.0d0*cl2)*ovin(2) &
                  + cn*cm*(cl2-1.0d0)*ovin(3)                                           ! dzx,dxy
        ovout(15)= 3.0d0*cm2*cn*cl*ovin(1) + cn*cl*(1.0d0-4.0d0*cm2)*ovin(2) &
                  + cn*cl*(cm2-1.0d0)*ovin(3)                                           ! dyz,dxy
        ovout(16)= ovout(4)                                                             ! dx2,dzx = dzx,dx2
        ovout(17)= ovout(9)                                                             ! dz2,dzx = dzx,dz2
        ovout(18)= ovout(14)                                                            ! dxy,dzx = dzx,dxy
        ovout(19)= 3.0d0*cn2*cl2*ovin(1) + (cn2+cl2-4.0d0*cn2*cl2)*ovin(2) &
                  + (cm2+cn2*cl2)*ovin(3)                                               ! dzx,dzy
        ovout(20)= 3.0d0*cm*cn2*cl*ovin(1) + cm*cl*(1.0d0-4.0d0*cn2)*ovin(2) &
                  + cm*cl*(cn2-1.0d0)*ovin(3)                                           ! dyz,dzx
        ovout(21)= ovout(5)                                                             ! dx2,dyz = dyz,dx2
        ovout(22)= ovout(10)                                                            ! dz2,dyz = dyz,dz2
        ovout(23)= ovout(15)                                                            ! dxy,dyz = dyz,dxy
        ovout(24)= ovout(20)                                                            ! dzx,dyz = dyz,dzx
        ovout(25)= 3.0d0*cm2*cn2*ovin(1) + (cm2+cn2-4.0d0*cm2*cn2)*ovin(2) &
                  + (cl2+cm2*cn2)*ovin(3)                                               !dyz,dyz

      case default
       write(*,'(a,i3,/a)') 'twocenter: parameter ITYPE had an ilegal value =', itype
       stop

      end select

      return
      end subroutine twocenter

! -----------------------------------------------------------------------------
end module sto_ov
! -----------------------------------------------------------------------------

